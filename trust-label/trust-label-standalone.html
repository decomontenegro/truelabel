<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRUST LABEL - Sistema Completo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .shadow-card { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <svg class="w-8 h-8" viewBox="0 0 40 40" fill="none">
                        <path d="M8 8h8v24H8V8z" fill="#000"/>
                        <path d="M16 8h16v8H16V8z" fill="#000"/>
                        <circle cx="24" cy="24" r="8" fill="#000"/>
                    </svg>
                    <span class="text-xl font-bold">trust</span>
                    <span class="text-xl">label</span>
                </div>
                <span class="text-sm text-gray-600">Versão Standalone - Funciona sem servidor!</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-gray-900">Sistema de Validação TRUST LABEL</h1>
            <p class="text-gray-600 mt-2">Cadastre e valide produtos com tecnologia AI</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Cadastro de Produto -->
            <div class="bg-white rounded-xl shadow-card p-6">
                <h2 class="text-xl font-bold mb-4">Cadastrar Produto</h2>
                <form id="productForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nome do Produto</label>
                        <input type="text" id="productName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Código EAN</label>
                        <input type="text" id="productEAN" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                        <select id="productCategory" required class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">Selecione...</option>
                            <option value="suplemento">Suplemento Alimentar</option>
                            <option value="alimento">Alimento</option>
                            <option value="bebida">Bebida</option>
                        </select>
                    </div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">
                        Cadastrar e Validar
                    </button>
                </form>
            </div>

            <!-- Lista de Produtos -->
            <div class="bg-white rounded-xl shadow-card p-6">
                <h2 class="text-xl font-bold mb-4">Produtos Validados</h2>
                <div id="productsList" class="space-y-3">
                    <p class="text-gray-500 text-sm">Nenhum produto cadastrado ainda.</p>
                </div>
            </div>
        </div>

        <!-- Resultado da Validação -->
        <div id="validationResult" class="mt-8 hidden">
            <div class="bg-white rounded-xl shadow-card overflow-hidden">
                <div class="bg-blue-600 text-white p-4">
                    <h2 class="text-2xl font-bold">2025 <span class="font-normal">Relatório de Validação</span></h2>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Detalhes do Produto -->
                        <div>
                            <h3 class="font-semibold text-lg mb-3">Produto Validado</h3>
                            <div id="productDetails" class="space-y-2">
                                <!-- Detalhes serão inseridos aqui -->
                            </div>
                            <div class="mt-4">
                                <h4 class="font-medium mb-2">QR Code</h4>
                                <canvas id="qrcode"></canvas>
                            </div>
                        </div>

                        <!-- Resultados da Validação -->
                        <div>
                            <h3 class="font-semibold text-lg mb-3">Resultados da Análise</h3>
                            <div class="space-y-3">
                                <div class="p-3 bg-gray-50 rounded-lg flex justify-between">
                                    <span>Perfil Nutricional</span>
                                    <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Aprovado</span>
                                </div>
                                <div class="p-3 bg-gray-50 rounded-lg flex justify-between">
                                    <span>Metais Pesados</span>
                                    <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Aprovado</span>
                                </div>
                                <div class="p-3 bg-gray-50 rounded-lg flex justify-between">
                                    <span>Alergênicos</span>
                                    <span class="px-2 py-1 bg-yellow-400 text-gray-900 text-xs rounded-full">Atenção</span>
                                </div>
                                <div class="p-3 bg-gray-50 rounded-lg flex justify-between">
                                    <span>Certificações</span>
                                    <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Aprovado</span>
                                </div>
                            </div>

                            <!-- Análise AI -->
                            <div class="mt-4 p-4 bg-purple-50 rounded-lg">
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="font-medium">Análise AI</h4>
                                    <span class="text-xs bg-purple-200 text-purple-700 px-2 py-1 rounded-full">Powered by AI</span>
                                </div>
                                <div class="grid grid-cols-2 gap-3 mb-3">
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-purple-600">95%</div>
                                        <div class="text-xs text-gray-600">Confiança</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-green-600">A+</div>
                                        <div class="text-xs text-gray-600">Score</div>
                                    </div>
                                </div>
                                <p class="text-sm text-gray-700">
                                    Produto de alta qualidade com todos os parâmetros dentro dos limites regulatórios.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Banco de dados local (localStorage)
        let products = JSON.parse(localStorage.getItem('trustLabelProducts') || '[]');

        // Função para gerar ID único
        function generateId() {
            return 'TL' + Date.now() + Math.random().toString(36).substr(2, 9).toUpperCase();
        }

        // Carregar produtos ao iniciar
        function loadProducts() {
            const listEl = document.getElementById('productsList');
            if (products.length === 0) {
                listEl.innerHTML = '<p class="text-gray-500 text-sm">Nenhum produto cadastrado ainda.</p>';
                return;
            }

            listEl.innerHTML = products.map(product => `
                <div class="p-3 bg-gray-50 rounded-lg">
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="font-medium">${product.name}</div>
                            <div class="text-sm text-gray-600">EAN: ${product.ean}</div>
                        </div>
                        <button onclick="showValidation('${product.id}')" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            Ver Validação
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Cadastrar e validar produto
        document.getElementById('productForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const product = {
                id: generateId(),
                name: document.getElementById('productName').value,
                ean: document.getElementById('productEAN').value,
                category: document.getElementById('productCategory').value,
                validatedAt: new Date().toISOString(),
                status: 'VALIDATED'
            };

            // Simular processo de validação
            const button = e.target.querySelector('button[type="submit"]');
            const originalText = button.textContent;
            button.textContent = 'Validando com IA...';
            button.disabled = true;

            await new Promise(resolve => setTimeout(resolve, 2000));

            // Salvar produto
            products.push(product);
            localStorage.setItem('trustLabelProducts', JSON.stringify(products));

            // Resetar formulário
            e.target.reset();
            button.textContent = originalText;
            button.disabled = false;

            // Atualizar lista e mostrar validação
            loadProducts();
            showValidation(product.id);
        });

        // Mostrar validação
        function showValidation(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            // Mostrar detalhes do produto
            document.getElementById('productDetails').innerHTML = `
                <div class="space-y-2">
                    <p><strong>Nome:</strong> ${product.name}</p>
                    <p><strong>EAN:</strong> ${product.ean}</p>
                    <p><strong>Categoria:</strong> ${product.category}</p>
                    <p><strong>ID:</strong> ${product.id}</p>
                    <p><strong>Validado em:</strong> ${new Date(product.validatedAt).toLocaleDateString('pt-BR')}</p>
                </div>
            `;

            // Gerar QR Code
            const qrText = `https://trustlabel.com/v/${product.id}`;
            QRCode.toCanvas(document.getElementById('qrcode'), qrText, {
                width: 150,
                margin: 2
            });

            // Mostrar resultado
            document.getElementById('validationResult').classList.remove('hidden');
            
            // Scroll para o resultado
            document.getElementById('validationResult').scrollIntoView({ behavior: 'smooth' });
        }

        // Limpar dados (botão oculto)
        function clearData() {
            if (confirm('Deseja limpar todos os dados?')) {
                localStorage.removeItem('trustLabelProducts');
                products = [];
                loadProducts();
                document.getElementById('validationResult').classList.add('hidden');
            }
        }

        // Carregar produtos ao iniciar
        loadProducts();

        // Adicionar botão oculto para limpar dados (Ctrl+Shift+C)
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                clearData();
            }
        });
    </script>
</body>
</html>