import{r as e,j as a,V as l}from"./react-core-XCdXHkeW.js";import{b as r}from"./index-D7IercYq.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./react-router-G9IXNjIc.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";const t=()=>{var t,d;const[i,s]=e.useState(null),[o,n]=e.useState(!1),[c]=e.useState("04aa9c1a-c7c2-48a9-84ce-560e50914dfe");return a.jsxs("div",{className:"container mx-auto px-4 py-8",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"\ud83e\uddea Teste de QR Code"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Controles de Teste"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product ID"}),a.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("button",{onClick:async()=>{try{n(!0);const e=await r.post("/qr/generate",{productId:c});s(e.data),l.success("QR Code gerado com sucesso!")}catch(e){l.error("Erro ao gerar QR Code")}finally{n(!1)}},disabled:o,className:"w-full btn btn-primary",children:o?"\u23f3 Gerando...":"\ud83d\udd04 Gerar QR (Axios)"}),a.jsx("button",{onClick:async()=>{var e;try{n(!0);const a=localStorage.getItem("auth-storage"),r=a?JSON.parse(a):null,t=null==(e=null==r?void 0:r.state)?void 0:e.token,d=await fetch("http://localhost:3000/api/qr/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({productId:c})});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const i=await d.json();s(i),l.success("QR Code gerado via API direta!")}catch(a){l.error("Erro na API direta")}finally{n(!1)}},disabled:o,className:"w-full btn btn-outline",children:o?"\u23f3 Testando...":"\ud83d\udd17 Testar API Direta (Fetch)"}),a.jsx("button",{onClick:()=>{s(null),l.success("Dados limpos")},className:"w-full btn btn-outline",children:"\ud83d\uddd1\ufe0f Limpar Dados"})]})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Resultado"}),i?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block p-4 bg-gray-50 border rounded-lg",children:a.jsx("img",{src:i.qrCodeImage,alt:"QR Code",className:"w-32 h-32 mx-auto",onError:e=>{e.currentTarget.style.display="none"},onLoad:()=>{}})}),a.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["C\xf3digo: ",i.qrCode]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"QR Code"}),a.jsx("p",{className:"text-sm font-mono bg-gray-50 p-2 rounded",children:i.qrCode})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"URL de Valida\xe7\xe3o"}),a.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded break-all",children:i.validationUrl})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Produto"}),a.jsxs("p",{className:"text-sm bg-gray-50 p-2 rounded",children:[null==(t=i.product)?void 0:t.name," (",null==(d=i.product)?void 0:d.brand,")"]})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>{navigator.clipboard.writeText(i.validationUrl),l.success("URL copiada!")},className:"flex-1 btn btn-outline btn-sm",children:"\ud83d\udccb Copiar URL"}),a.jsx("button",{onClick:()=>{window.open(i.validationUrl,"_blank")},className:"flex-1 btn btn-outline btn-sm",children:"\ud83d\udd17 Abrir URL"})]})]}):a.jsxs("div",{className:"text-center text-gray-500 py-8",children:[a.jsx("div",{className:"text-4xl mb-2",children:"\ud83d\udcf1"}),a.jsx("p",{children:"Nenhum QR Code gerado ainda"})]})]})]}),a.jsxs("div",{className:"mt-6 bg-gray-100 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"\ud83d\udccb Debug Info:"}),a.jsxs("ul",{className:"text-sm space-y-1",children:[a.jsx("li",{children:"\u2022 Abra o console do navegador para ver logs detalhados"}),a.jsx("li",{children:"\u2022 Teste primeiro com Axios (usa interceptor)"}),a.jsx("li",{children:"\u2022 Teste depois com Fetch (API direta)"}),a.jsx("li",{children:"\u2022 Verifique se a imagem do QR Code carrega"}),a.jsx("li",{children:"\u2022 Teste a URL de valida\xe7\xe3o"})]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),a.jsx("div",{className:"mt-2 text-sm",children:"Processando..."})]})})]})};export{t as default};
