import{r as e,V as a,j as s,af as r,ak as i,F as t,aS as l,bs as c,a9 as o,n as d,X as n,o as m,a3 as h}from"./react-core-XCdXHkeW.js";import{u as p,b as x,L as u}from"./index-D7IercYq.js";import{C as N,B as f}from"./Card-riUsgTF1.js";import{b as v}from"./react-router-G9IXNjIc.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";function g(){const g=v(),{user:y}=p(),[b,w]=e.useState(!0),[C,E]=e.useState([]),[k,j]=e.useState(null),[P,D]=e.useState(!1),[T,R]=e.useState(!1),[S,O]=e.useState(""),[I,z]=e.useState(""),[A,L]=e.useState(!1);e.useEffect((()=>{y?B():g("/login")}),[y,g]);const B=async()=>{try{const[e,a]=await Promise.all([x.get("/privacy/requests"),x.get("/privacy/consents")]);E(e.data.requests),j(a.data)}catch(e){a.error("Erro ao carregar dados de privacidade")}finally{w(!1)}},M=async e=>{try{const s=await x.get(`/privacy/data/export?format=${e}`,{responseType:"blob"}),r=new Blob([s.data],{type:"json"===e?"application/json":"text/csv"}),i=window.URL.createObjectURL(r),t=document.createElement("a");t.href=i,t.download=`meus-dados-truelabel.${e}`,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(i),document.body.removeChild(t),a.success("Dados exportados com sucesso!")}catch(s){a.error("Erro ao exportar dados")}},q=async(e,s)=>{try{await x.post("/privacy/consents",{consents:{[e]:s}}),a.success("Prefer\xeancias atualizadas"),B()}catch(r){a.error("Erro ao atualizar prefer\xeancias")}};return b?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx(u,{size:"large"})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Central de Privacidade"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Gerencie seus dados pessoais e prefer\xeancias de privacidade"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[s.jsxs(N,{className:"p-6 text-center hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>R(!0),children:[s.jsx(r,{className:"h-8 w-8 text-primary-600 mx-auto mb-3"}),s.jsx("h3",{className:"font-semibold",children:"Exportar Dados"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Baixe seus dados pessoais"})]}),s.jsxs(N,{className:"p-6 text-center hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>g("/settings/profile"),children:[s.jsx(i,{className:"h-8 w-8 text-primary-600 mx-auto mb-3"}),s.jsx("h3",{className:"font-semibold",children:"Editar Dados"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Atualize suas informa\xe7\xf5es"})]}),s.jsxs(N,{className:"p-6 text-center hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>window.open("/privacy-policy","_blank"),children:[s.jsx(t,{className:"h-8 w-8 text-primary-600 mx-auto mb-3"}),s.jsx("h3",{className:"font-semibold",children:"Pol\xedtica de Privacidade"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Leia nossa pol\xedtica"})]}),s.jsxs(N,{className:"p-6 text-center hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>D(!0),children:[s.jsx(l,{className:"h-8 w-8 text-red-600 mx-auto mb-3"}),s.jsx("h3",{className:"font-semibold text-red-600",children:"Excluir Conta"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Remova todos seus dados"})]})]}),s.jsx(N,{className:"mb-8",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(c,{className:"h-6 w-6 text-primary-600 mr-3"}),s.jsx("h2",{className:"text-xl font-semibold",children:"Prefer\xeancias de Cookies"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium",children:"Cookies Necess\xe1rios"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Essenciais para o funcionamento do site"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-sm text-gray-500 mr-3",children:"Sempre ativos"}),s.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"h-5 w-5 text-primary-600 rounded cursor-not-allowed"})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium",children:"Cookies Anal\xedticos"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Nos ajudam a melhorar o site atrav\xe9s de estat\xedsticas"})]}),s.jsx("input",{type:"checkbox",checked:(null==k?void 0:k.analytics)||!1,onChange:e=>q("analytics",e.target.checked),className:"h-5 w-5 text-primary-600 rounded focus:ring-primary-500"})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium",children:"Cookies de Marketing"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Usados para personalizar an\xfancios e conte\xfado"})]}),s.jsx("input",{type:"checkbox",checked:(null==k?void 0:k.marketing)||!1,onChange:e=>q("marketing",e.target.checked),className:"h-5 w-5 text-primary-600 rounded focus:ring-primary-500"})]})]})]})}),s.jsx(N,{children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(o,{className:"h-6 w-6 text-primary-600 mr-3"}),s.jsx("h2",{className:"text-xl font-semibold",children:"Hist\xf3rico de Solicita\xe7\xf5es"})]}),0===C.length?s.jsx("p",{className:"text-gray-600",children:"Nenhuma solicita\xe7\xe3o de privacidade registrada."}):s.jsx("div",{className:"space-y-3",children:C.map((e=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:["COMPLETED"===e.status?s.jsx(d,{className:"h-5 w-5 text-green-600 mr-3"}):"REJECTED"===e.status?s.jsx(n,{className:"h-5 w-5 text-red-600 mr-3"}):s.jsx(m,{className:"h-5 w-5 text-yellow-600 mr-3"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium",children:["DELETION"===e.type&&"Exclus\xe3o de Dados","ACCESS"===e.type&&"Acesso aos Dados","RECTIFICATION"===e.type&&"Retifica\xe7\xe3o de Dados","PORTABILITY"===e.type&&"Portabilidade de Dados"]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Solicitado em ",new Date(e.requestedAt).toLocaleDateString("pt-BR")]})]})]}),s.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium "+("COMPLETED"===e.status?"bg-green-100 text-green-800":"REJECTED"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:["COMPLETED"===e.status&&"Conclu\xedda","REJECTED"===e.status&&"Rejeitada","PENDING"===e.status&&"Pendente","IN_PROGRESS"===e.status&&"Em Progresso"]})]},e.id)))})]})}),T&&s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:()=>R(!1)}),s.jsxs("div",{className:"relative bg-white rounded-lg max-w-md w-full p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Exportar Dados Pessoais"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Escolha o formato para exportar seus dados pessoais. O arquivo conter\xe1 todas as informa\xe7\xf5es que temos sobre voc\xea."}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(f,{variant:"outline",onClick:()=>{M("json"),R(!1)},className:"flex-1",children:"Exportar JSON"}),s.jsx(f,{variant:"primary",onClick:()=>{M("csv"),R(!1)},className:"flex-1",children:"Exportar CSV"})]}),s.jsx(f,{variant:"ghost",onClick:()=>R(!1),className:"w-full mt-3",children:"Cancelar"})]})]})}),P&&s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:()=>D(!1)}),s.jsxs("div",{className:"relative bg-white rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(h,{className:"h-6 w-6 text-red-600 mr-3"}),s.jsx("h2",{className:"text-xl font-semibold",children:"Excluir Conta"})]}),s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[s.jsxs("p",{className:"text-sm text-red-800",children:[s.jsx("strong",{children:"Aten\xe7\xe3o:"})," Esta a\xe7\xe3o \xe9 irrevers\xedvel. Todos os seus dados ser\xe3o permanentemente removidos de nossos sistemas, incluindo:"]}),s.jsxs("ul",{className:"mt-2 text-sm text-red-700 list-disc list-inside",children:[s.jsx("li",{children:"Informa\xe7\xf5es pessoais"}),s.jsx("li",{children:"Produtos e valida\xe7\xf5es"}),s.jsx("li",{children:"Hist\xf3rico de atividades"}),s.jsx("li",{children:"Acesso \xe0 plataforma"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo da exclus\xe3o"}),s.jsx("textarea",{value:S,onChange:e=>O(e.target.value),className:"w-full p-3 border rounded-lg resize-none",rows:3,placeholder:"Por favor, nos diga por que est\xe1 excluindo sua conta..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirme seu email"}),s.jsx("input",{type:"email",value:I,onChange:e=>z(e.target.value),className:"w-full p-3 border rounded-lg",placeholder:null==y?void 0:y.email})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx(f,{variant:"outline",onClick:()=>D(!1),disabled:A,className:"flex-1",children:"Cancelar"}),s.jsx(f,{variant:"danger",onClick:async()=>{var e,s;if(S&&I)if(I===(null==y?void 0:y.email)){L(!0);try{await x.post("/privacy/data/delete",{reason:S,confirmEmail:I}),a.success("Solicita\xe7\xe3o de exclus\xe3o processada. Voc\xea receber\xe1 um email de confirma\xe7\xe3o."),D(!1),setTimeout((()=>{p.getState().logout(),g("/")}),3e3)}catch(r){a.error((null==(s=null==(e=r.response)?void 0:e.data)?void 0:s.error)||"Erro ao processar solicita\xe7\xe3o")}finally{L(!1)}}else a.error("O email de confirma\xe7\xe3o n\xe3o corresponde");else a.error("Por favor, preencha todos os campos")},loading:A,className:"flex-1",children:"Excluir Permanentemente"})]})]})]})})]})}export{g as default};
