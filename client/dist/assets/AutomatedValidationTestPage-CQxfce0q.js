import{c as e,j as s,R as a,M as t,d as i,C as l,e as n}from"./index--pVY8JWu.js";import{r}from"./vendor-BDxjXY-2.js";import{W as c,r as d,v as o}from"./validationService-NvwJQYBM.js";import{u as m}from"./useAsyncAction-CAXDwRpP.js";import{C as x}from"./circle-x-Clc4I5eS.js";import{T as u}from"./triangle-alert-DpA1U4cI.js";import{A as h}from"./activity-Lu2p3PbY.js";import"./charts-C38Ohhsz.js";import"./fallbackService-D-6NybDe.js";import"./qrService-DE6BdSVq.js";
/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=e("circle-play",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);function j(){const[e,j]=r.useState(null),[g,b]=r.useState(null),[v,N]=r.useState(null),[f,y]=r.useState([]),[w,A]=r.useState([]),[E,I]=r.useState([]),[S,C]=r.useState(null),{execute:k}=m((async()=>{const[e,s]=await Promise.all([t.getProducts({limit:20}),d.getReports({limit:20})]);A(e.data),I(s.data)})),{execute:R,loading:L}=m((async s=>{if(!g||!e)throw new Error("Please select a product and report");const a=await o.queueAutomatedValidation(g.id,e.id,s);return V(),a}));m((async e=>{await o.cancelAutomatedValidation(e),V()})),m((async e=>{await o.retryAutomatedValidation(e),V()}));const V=async()=>{const e=await o.getAutomatedQueueStatus();N(e)};r.useEffect((()=>{k(),V();const e=setInterval((()=>{V()}),2e3);return C(e),()=>{e&&clearInterval(e)}}),[]);const D=e=>{switch(e){case c.QUEUED:return s.jsx(i,{className:"w-5 h-5 text-gray-500"});case c.ANALYZING:return s.jsx(h,{className:"w-5 h-5 text-blue-500 animate-pulse"});case c.VALIDATING:return s.jsx(n,{className:"w-5 h-5 text-purple-500 animate-pulse"});case c.REVIEW_REQUIRED:return s.jsx(u,{className:"w-5 h-5 text-yellow-500"});case c.COMPLETED:return s.jsx(l,{className:"w-5 h-5 text-green-500"});case c.FAILED:return s.jsx(x,{className:"w-5 h-5 text-red-500"});default:return s.jsx(i,{className:"w-5 h-5 text-gray-400"})}};return s.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[s.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Automated Validation Engine Test"}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsxs("h2",{className:"text-xl font-semibold flex items-center justify-between",children:[s.jsx("span",{children:"Queue Status"}),s.jsxs("button",{onClick:V,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[s.jsx(a,{className:"w-4 h-4"}),"Refresh"]})]})}),s.jsx("div",{className:"p-6",children:v&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold",children:v.totalItems}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total Items"})]}),Object.entries(v.byState||{}).map((([e,a])=>s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"flex justify-center mb-2",children:D(e)}),s.jsx("div",{className:"text-xl font-semibold",children:a}),s.jsx("div",{className:"text-sm text-gray-600",children:e})]},e)))]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsx("h2",{className:"text-xl font-semibold",children:"Queue New Validation"})}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Product"}),s.jsxs("select",{className:"w-full p-2 border rounded-lg",value:(null==e?void 0:e.id)||"",onChange:e=>{const s=w.find((s=>s.id===e.target.value));j(s)},children:[s.jsx("option",{value:"",children:"Choose a product..."}),w.map((e=>s.jsxs("option",{value:e.id,children:[e.name," - ",e.brand," (SKU: ",e.sku,")"]},e.id)))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Report"}),s.jsxs("select",{className:"w-full p-2 border rounded-lg",value:(null==g?void 0:g.id)||"",onChange:e=>{const s=E.find((s=>s.id===e.target.value));b(s)},children:[s.jsx("option",{value:"",children:"Choose a report..."}),E.map((e=>{var a;return s.jsxs("option",{value:e.id,children:[e.originalName," - ",e.analysisType," (",null==(a=e.laboratory)?void 0:a.name,")"]},e.id)}))]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>R("URGENT"),disabled:L||!e||!g,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 flex items-center gap-2",children:[s.jsx(p,{className:"w-4 h-4"}),"Queue as Urgent"]}),s.jsxs("button",{onClick:()=>R("HIGH"),disabled:L||!e||!g,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 flex items-center gap-2",children:[s.jsx(p,{className:"w-4 h-4"}),"Queue as High"]}),s.jsxs("button",{onClick:()=>R("NORMAL"),disabled:L||!e||!g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:[s.jsx(p,{className:"w-4 h-4"}),"Queue as Normal"]}),s.jsxs("button",{onClick:()=>R("LOW"),disabled:L||!e||!g,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50 flex items-center gap-2",children:[s.jsx(p,{className:"w-4 h-4"}),"Queue as Low"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsx("h2",{className:"text-xl font-semibold",children:"Example Analysis Output"})}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Analysis Result Structure:"}),s.jsx("pre",{className:"text-xs bg-white p-3 rounded border overflow-x-auto",children:'{\n  "id": "analysis-1234567890",\n  "timestamp": "2024-01-15T10:30:00Z",\n  "algorithm": "TrueLabel-AutoValidator-v1.0",\n  "version": "1.0.0",\n  "confidence": 92.5,\n  "processingTime": 1250,\n  "findings": [\n    {\n      "category": "COMPLIANCE",\n      "severity": "HIGH",\n      "dataPoint": "sodium",\n      "description": "Value 2500mg/100g exceeds maximum limit",\n      "evidence": {"value": 2500, "unit": "mg/100g"},\n      "suggestedAction": "Review product formulation"\n    },\n    {\n      "category": "CONSISTENCY",\n      "severity": "MEDIUM",\n      "dataPoint": "calories",\n      "description": "Caloric value deviates 12% from expected",\n      "evidence": "Reported: 380 kcal, Expected: 425 kcal",\n      "suggestedAction": "Verify caloric calculation method"\n    }\n  ],\n  "recommendations": [\n    "Address 1 critical compliance issue before approval",\n    "Review 2 moderate issues for potential improvement",\n    "Implement data validation checks"\n  ]\n}'})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Validation Rules Applied:"}),s.jsxs("ul",{className:"text-sm space-y-1",children:[s.jsx("li",{children:"• Nutritional limits (protein, fat, carbs, sodium, etc.)"}),s.jsx("li",{children:"• Microbiological safety (coliforms, salmonella, listeria)"}),s.jsx("li",{children:"• Data consistency checks (macronutrient sum, caloric calculation)"}),s.jsx("li",{children:"• Anomaly detection (placeholder values, precision errors)"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Confidence Score Calculation:"}),s.jsxs("ul",{className:"text-sm space-y-1",children:[s.jsx("li",{children:"• Base score: 100%"}),s.jsx("li",{children:"• HIGH severity finding: -20 points each"}),s.jsx("li",{children:"• MEDIUM severity finding: -10 points each"}),s.jsx("li",{children:"• LOW severity finding: -5 points each"}),s.jsx("li",{children:"• Minimum threshold for auto-approval: 85%"})]})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"p-6 border-b",children:s.jsx("h2",{className:"text-xl font-semibold",children:"Workflow States"})}),s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"space-y-3",children:Object.entries(c).map((([e,a])=>s.jsxs("div",{className:"flex items-center gap-3",children:[D(a),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:a}),s.jsxs("div",{className:"text-sm text-gray-600",children:[a===c.QUEUED&&"Waiting in queue for processing",a===c.ANALYZING&&"Parsing and analyzing report data",a===c.VALIDATING&&"Applying validation rules and scoring",a===c.REVIEW_REQUIRED&&"Manual review needed (confidence < 85%)",a===c.COMPLETED&&"Validation created successfully",a===c.FAILED&&"Processing failed after max attempts"]})]})]},e)))})})]})]})}export{j as default};
