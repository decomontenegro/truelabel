import{c as a,U as e,j as s,C as t,Y as r}from"./index-DVDeh87x.js";import{r as i}from"./vendor-BDxjXY-2.js";import{P as l}from"./plus-DN1tBbCM.js";import{S as o}from"./search-Bs3zZnHQ.js";import{C as c}from"./circle-x-DtLsNPzF.js";import{M as n}from"./mail-CdfX4gVe.js";import{P as d}from"./phone-Cw1tKQsi.js";import{M as m}from"./map-pin-BLaYBl8C.js";import{S as x}from"./square-pen-CSblEvl6.js";import{T as h}from"./trash-2-CGoK6HbH.js";import"./charts-C38Ohhsz.js";
/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=a("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),p={async getLaboratories(a={}){const s=new URLSearchParams;Object.entries(a).forEach((([a,e])=>{void 0!==e&&""!==e&&s.append(a,String(e))}));const t=await e.get(`/laboratories?${s.toString()}`),r=t.data.laboratories||[];return{data:r,pagination:t.data.pagination||{page:1,limit:10,total:r.length,totalPages:1}}},getLaboratory:async a=>(await e.get(`/laboratories/${a}`)).data,createLaboratory:async a=>(await e.post("/laboratories",a)).data,updateLaboratory:async(a,s)=>(await e.put(`/laboratories/${a}`,s)).data,updateLaboratoryStatus:async(a,s)=>(await e.patch(`/laboratories/${a}/status`,{isActive:s})).data,deleteLaboratory:async a=>(await e.delete(`/laboratories/${a}`)).data,getLaboratoryStats:async a=>(await e.get(`/laboratories/${a}/stats`)).data,async getActiveLaboratories(){return(await this.getLaboratories({active:!0,limit:100})).data},async searchLaboratories(a){return(await this.getLaboratories({search:a,active:!0,limit:20})).data},async checkEmailAvailability(a,e){try{const s=(await this.getLaboratories({limit:1e3})).data;return{available:!s.some((s=>s.email.toLowerCase()===a.toLowerCase()&&(!e||s.id!==e)))}}catch(s){return{available:!1}}},async getTopLaboratories(a=5){return(await this.getLaboratories({limit:100})).data.sort(((a,e)=>{var s,t;const r=(null==(s=a._count)?void 0:s.reports)||0;return((null==(t=e._count)?void 0:t.reports)||0)-r})).slice(0,a)},validateLaboratoryData(a){const e=[];return(!a.name||a.name.trim().length<2)&&e.push("Nome deve ter pelo menos 2 caracteres"),(!a.accreditation||a.accreditation.trim().length<1)&&e.push("Acreditação é obrigatória"),a.email&&this.isValidEmail(a.email)||e.push("Email inválido"),a.phone&&!this.isValidPhone(a.phone)&&e.push("Telefone inválido"),{isValid:0===e.length,errors:e}},isValidEmail:a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),isValidPhone:a=>/^(\(?\d{2}\)?\s?)?\d{4,5}-?\d{4}$/.test(a.replace(/\s/g,"")),formatPhone(a){const e=a.replace(/\D/g,"");return 10===e.length?`(${e.slice(0,2)}) ${e.slice(2,6)}-${e.slice(6)}`:11===e.length?`(${e.slice(0,2)}) ${e.slice(2,7)}-${e.slice(7)}`:a},getCommonAccreditations:()=>["ISO/IEC 17025:2017","ISO/IEC 17025:2005","ABNT NBR ISO/IEC 17025","INMETRO","ANVISA","MAPA","Rede Brasileira de Laboratórios de Ensaios","CGCRE","Outros"]},u=()=>{const[a,e]=i.useState([]),[u,v]=i.useState(!0),[y,N]=i.useState(""),[f,w]=i.useState(!1),[C,L]=i.useState(null),S=async()=>{try{v(!0);const a=await p.getLaboratories({search:y,limit:100});e(a.data)}catch(a){r.error("Erro ao carregar laboratórios")}finally{v(!1)}};i.useEffect((()=>{S()}),[y]);return u?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"loading-spinner w-8 h-8"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Laboratórios"}),s.jsx("p",{className:"text-gray-600",children:"Gerencie laboratórios certificados"})]}),s.jsxs("button",{onClick:()=>w(!0),className:"btn btn-primary",children:[s.jsx(l,{className:"w-4 h-4 mr-2"}),"Novo Laboratório"]})]}),s.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:s.jsx("div",{className:"flex gap-4",children:s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx("input",{type:"text",placeholder:"Buscar laboratórios...",value:y,onChange:a=>N(a.target.value),className:"input pl-10"})]})})})}),s.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:a.map((a=>{var e;return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(b,{className:"w-8 h-8 text-blue-600 mr-3"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:a.name}),s.jsx("p",{className:"text-sm text-gray-600",children:a.accreditation})]})]}),s.jsx("div",{className:"flex items-center space-x-2",children:a.isActive?s.jsx(t,{className:"w-5 h-5 text-green-500"}):s.jsx(c,{className:"w-5 h-5 text-red-500"})})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(n,{className:"w-4 h-4 mr-2"}),a.email]}),a.phone&&s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(d,{className:"w-4 h-4 mr-2"}),a.phone]}),a.address&&s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(m,{className:"w-4 h-4 mr-2"}),a.address]})]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:(null==(e=a._count)?void 0:e.reports)||0})," relatórios enviados"]})}),s.jsx("div",{className:"mb-4",children:s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.isActive?"Ativo":"Inativo"})}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs("button",{onClick:()=>L(a),className:"flex-1 btn btn-outline text-sm",children:[s.jsx(x,{className:"w-4 h-4 mr-1"}),"Editar"]}),s.jsx("button",{onClick:()=>(async a=>{try{await p.updateLaboratoryStatus(a.id,!a.isActive),r.success(`Laboratório ${a.isActive?"desativado":"ativado"} com sucesso`),S()}catch(e){r.error("Erro ao alterar status do laboratório")}})(a),className:"flex-1 btn text-sm "+(a.isActive?"btn-secondary":"btn-primary"),children:a.isActive?"Desativar":"Ativar"}),s.jsx("button",{onClick:()=>(async a=>{var e,s;if(confirm(`Tem certeza que deseja remover o laboratório "${a.name}"?`))try{await p.deleteLaboratory(a.id),r.success("Laboratório removido com sucesso"),S()}catch(t){r.error((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.message)||"Erro ao remover laboratório")}})(a),className:"btn btn-outline text-red-600 hover:bg-red-50 text-sm px-3",children:s.jsx(h,{className:"w-4 h-4"})})]})]},a.id)}))}),0===a.length&&!u&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(b,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum laboratório encontrado"}),s.jsx("p",{className:"text-gray-600 mb-4",children:y?"Tente ajustar os filtros de busca":"Comece cadastrando o primeiro laboratório"}),!y&&s.jsxs("button",{onClick:()=>w(!0),className:"btn btn-primary",children:[s.jsx(l,{className:"w-4 h-4 mr-2"}),"Cadastrar Laboratório"]})]}),f&&s.jsx(j,{onClose:()=>w(!1),onSuccess:()=>{w(!1),S()}}),C&&s.jsx(g,{laboratory:C,onClose:()=>L(null),onSuccess:()=>{L(null),S()}})]})},j=({onClose:a,onSuccess:e})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"Novo Laboratório"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Modal de criação será implementado na próxima etapa"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:a,className:"btn btn-secondary flex-1",children:"Cancelar"}),s.jsx("button",{onClick:e,className:"btn btn-primary flex-1",children:"Criar (Demo)"})]})]})}),g=({laboratory:a,onClose:e,onSuccess:t})=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"Editar Laboratório"}),s.jsxs("p",{className:"text-gray-600 mb-2",children:["Editando: ",a.name]}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Modal de edição será implementado na próxima etapa"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:e,className:"btn btn-secondary flex-1",children:"Cancelar"}),s.jsx("button",{onClick:t,className:"btn btn-primary flex-1",children:"Salvar (Demo)"})]})]})});export{u as LaboratoriesPage,u as default};
