import{O as e,j as a,L as s,J as t}from"./index-DeKtUJAc.js";import{i as r,e as o,r as i}from"./vendor-BDxjXY-2.js";import{p as l}from"./productService-DtNiporo.js";import{S as n}from"./save-DAYOlFoS.js";import"./charts-C38Ohhsz.js";const c=()=>{const{id:c}=r(),m=o(),[d,u]=i.useState(!0),[x,h]=i.useState(!1),[p,g]=i.useState({name:"",brand:"",category:"",sku:"",description:"",claims:"",nutritionalInfo:"",imageUrl:""});i.useEffect((()=>{c&&b()}),[c]);const b=async()=>{var a;try{u(!0);const e=await l.getProductById(c);g({name:e.name||"",brand:e.brand||"",category:e.category||"",sku:e.sku||"",description:e.description||"",claims:e.claims||"",nutritionalInfo:e.nutritionalInfo?JSON.stringify(e.nutritionalInfo,null,2):"",imageUrl:e.imageUrl||""})}catch(s){404===(null==(a=s.response)?void 0:a.status)?(e.error("Produto não encontrado"),m("/dashboard/products")):e.error("Erro ao carregar produto")}finally{u(!1)}},j=e=>{const{name:a,value:s}=e.target;g((e=>({...e,[a]:s})))};return d?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsx(s,{size:"lg"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:()=>m(`/dashboard/products/${c}`),className:"btn btn-outline btn-sm flex items-center",children:[a.jsx(t,{className:"h-4 w-4 mr-2"}),"Voltar"]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Editar Produto"}),a.jsx("p",{className:"text-gray-600",children:"Atualize as informações do produto"})]})]}),a.jsxs("form",{onSubmit:async a=>{var s,t,r;if(a.preventDefault(),p.name&&p.brand&&p.category&&p.sku)try{h(!0);let a=null;if(p.nutritionalInfo.trim())try{a=JSON.parse(p.nutritionalInfo)}catch(o){return void e.error("Formato JSON inválido nas informações nutricionais")}const s={...p,nutritionalInfo:a};await l.updateProduct(c,s),e.success("Produto atualizado com sucesso!"),m(`/dashboard/products/${c}`)}catch(i){400===(null==(s=i.response)?void 0:s.status)?e.error("Dados inválidos. Verifique os campos."):409===(null==(t=i.response)?void 0:t.status)?e.error("SKU já existe. Use um SKU único."):401===(null==(r=i.response)?void 0:r.status)?e.error("Sessão expirada. Faça login novamente."):e.error("Erro ao atualizar produto. Tente novamente.")}finally{h(!1)}else e.error("Preencha todos os campos obrigatórios")},className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informações Básicas"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Produto *"}),a.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:p.name,onChange:j,className:"input w-full",placeholder:"Ex: Whey Protein Premium"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"brand",className:"block text-sm font-medium text-gray-700 mb-2",children:"Marca *"}),a.jsx("input",{type:"text",id:"brand",name:"brand",required:!0,value:p.brand,onChange:j,className:"input w-full",placeholder:"Ex: NutriMax"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria *"}),a.jsxs("select",{id:"category",name:"category",required:!0,value:p.category,onChange:j,className:"input w-full",children:[a.jsx("option",{value:"",children:"Selecione uma categoria"}),["Alimentos","Bebidas","Suplementos","Cosméticos","Higiene Pessoal","Produtos Naturais","Outros"].map((e=>a.jsx("option",{value:e,children:e},e)))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"sku",className:"block text-sm font-medium text-gray-700 mb-2",children:"SKU *"}),a.jsx("input",{type:"text",id:"sku",name:"sku",required:!0,value:p.sku,onChange:j,className:"input w-full",placeholder:"Ex: WP-001-VAN"})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),a.jsx("textarea",{id:"description",name:"description",rows:4,value:p.description,onChange:j,className:"input w-full",placeholder:"Descreva o produto, seus benefícios e características..."})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700 mb-2",children:"URL da Imagem"}),a.jsx("input",{type:"url",id:"imageUrl",name:"imageUrl",value:p.imageUrl,onChange:j,className:"input w-full",placeholder:"https://exemplo.com/imagem-produto.jpg"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Claims e Alegações"}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"claims",className:"block text-sm font-medium text-gray-700 mb-2",children:"Claims do Produto"}),a.jsx("textarea",{id:"claims",name:"claims",rows:4,value:p.claims,onChange:j,className:"input w-full",placeholder:"Ex: Rico em proteínas, Sem açúcar adicionado, Fonte de vitaminas..."}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Separe múltiplos claims por vírgula"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informações Nutricionais"}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"nutritionalInfo",className:"block text-sm font-medium text-gray-700 mb-2",children:"Informações Nutricionais (JSON)"}),a.jsx("textarea",{id:"nutritionalInfo",name:"nutritionalInfo",rows:6,value:p.nutritionalInfo,onChange:j,className:"input w-full font-mono text-sm",placeholder:'{\n  "calorias": "120 kcal",\n  "proteinas": "25g",\n  "carboidratos": "2g",\n  "gorduras": "1g",\n  "fibras": "0g",\n  "sodio": "50mg"\n}'}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Formato JSON válido. Deixe em branco se não aplicável."})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[a.jsx("button",{type:"button",onClick:()=>m(`/dashboard/products/${c}`),className:"btn btn-secondary",disabled:x,children:"Cancelar"}),a.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x,children:x?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Salvando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(n,{className:"w-4 h-4 mr-2"}),"Salvar Alterações"]})})]})]})]})};export{c as default};
