import{u as e,U as s,j as t,L as a,b as l,d,C as r,G as i,e as n,f as c}from"./index-BwznawPq.js";import{e as o,r as m}from"./vendor-BDxjXY-2.js";import{C as x}from"./circle-x-1cgnZX5R.js";import{U as h}from"./upload-BNJsPqGL.js";import"./charts-C38Ohhsz.js";function g(){const g=o(),u=e((e=>e.user)),[p,j]=m.useState(!0),[N,v]=m.useState(null),[b,y]=m.useState(null);m.useEffect((()=>{f()}),[]);const f=async()=>{try{j(!0);const e=(await s.get("/validations")).data.data||[],t=(new Date).toDateString(),a=e.filter((e=>"APPROVED"===e.status&&new Date(e.createdAt).toDateString()===t)).length,l=e.length,d=e.filter((e=>"REJECTED"===e.status)).length,r=l>0?d/l*100:0,i=e.filter((e=>"APPROVED"===e.status)).slice(0,5).map((e=>({id:e.id,product:{name:e.productName},createdAt:e.createdAt,validations:[{status:e.status}]})));v({totalReports:e.filter((e=>"APPROVED"===e.status)).length,pendingValidations:e.filter((e=>"PENDING"===e.status)).length,completedToday:a,rejectionRate:Math.round(r),recentReports:i,pendingTasks:e.filter((e=>"PENDING"===e.status)).slice(0,5)})}catch(e){y("Erro ao carregar dados do dashboard")}finally{j(!1)}};return p?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx(a,{size:"lg"})}):b?t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:t.jsx("p",{className:"text-red-800",children:b})})}):t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard do Laboratório"}),t.jsxs("p",{className:"text-gray-600 mt-1",children:["Bem-vindo, ",null==u?void 0:u.name,"! Gerencie seus relatórios e validações."]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Relatórios"}),t.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:(null==N?void 0:N.totalReports)||0})]}),t.jsx("div",{className:"bg-primary-100 rounded-full p-3",children:t.jsx(l,{className:"h-6 w-6 text-primary-600"})})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Validações Pendentes"}),t.jsx("p",{className:"text-3xl font-bold text-yellow-600 mt-1",children:(null==N?void 0:N.pendingValidations)||0})]}),t.jsx("div",{className:"bg-yellow-100 rounded-full p-3",children:t.jsx(d,{className:"h-6 w-6 text-yellow-600"})})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Concluídos Hoje"}),t.jsx("p",{className:"text-3xl font-bold text-green-600 mt-1",children:(null==N?void 0:N.completedToday)||0})]}),t.jsx("div",{className:"bg-green-100 rounded-full p-3",children:t.jsx(r,{className:"h-6 w-6 text-green-600"})})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taxa de Rejeição"}),t.jsxs("p",{className:"text-3xl font-bold text-red-600 mt-1",children:[(null==N?void 0:N.rejectionRate)||0,"%"]})]}),t.jsx("div",{className:"bg-red-100 rounded-full p-3",children:t.jsx(x,{className:"h-6 w-6 text-red-600"})})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("button",{onClick:()=>g("/lab/reports/new"),className:"bg-primary-600 text-white rounded-lg p-6 hover:bg-primary-700 transition-colors",children:[t.jsx(h,{className:"h-8 w-8 mb-3"}),t.jsx("h3",{className:"text-lg font-semibold",children:"Novo Relatório"}),t.jsx("p",{className:"text-sm mt-1 opacity-90",children:"Fazer upload de análise"})]}),t.jsxs("button",{onClick:()=>g("/lab/validations"),className:"bg-white border-2 border-gray-200 rounded-lg p-6 hover:border-primary-600 transition-colors",children:[t.jsx(i,{className:"h-8 w-8 mb-3 text-gray-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Fila de Validação"}),t.jsxs("p",{className:"text-sm mt-1 text-gray-600",children:[(null==N?void 0:N.pendingValidations)||0," pendentes"]})]}),t.jsxs("button",{onClick:()=>g("/lab/analytics"),className:"bg-white border-2 border-gray-200 rounded-lg p-6 hover:border-primary-600 transition-colors",children:[t.jsx(n,{className:"h-8 w-8 mb-3 text-gray-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Relatórios"}),t.jsx("p",{className:"text-sm mt-1 text-gray-600",children:"Ver estatísticas"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tarefas Pendentes"}),(null==N?void 0:N.pendingTasks)&&N.pendingTasks.length>0?t.jsx("div",{className:"space-y-3",children:N.pendingTasks.map((e=>{var s;return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer",onClick:()=>g(`/lab/validations/${e.id}`),children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(d,{className:"h-5 w-5 text-yellow-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:e.productName||(null==(s=e.product)?void 0:s.name)||"Produto"}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Solicitado em ",c(e.createdAt)]})]})]}),t.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"Pendente"})]},e.id)}))}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhuma tarefa pendente"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Relatórios Recentes"}),(null==N?void 0:N.recentReports)&&N.recentReports.length>0?t.jsx("div",{className:"space-y-3",children:N.recentReports.map((e=>{var s,a,d,r,i,n,o,m,x;return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer",onClick:()=>g(`/lab/reports/${e.id}`),children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(l,{className:"h-5 w-5 text-primary-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:(null==(s=e.product)?void 0:s.name)||"Produto"}),t.jsx("p",{className:"text-sm text-gray-600",children:c(e.createdAt)})]})]}),t.jsx("span",{className:"text-sm font-medium "+("VALIDATED"===(null==(d=null==(a=e.validations)?void 0:a[0])?void 0:d.status)?"text-green-600":"REJECTED"===(null==(i=null==(r=e.validations)?void 0:r[0])?void 0:i.status)?"text-red-600":"text-yellow-600"),children:"VALIDATED"===(null==(o=null==(n=e.validations)?void 0:n[0])?void 0:o.status)?"Validado":"REJECTED"===(null==(x=null==(m=e.validations)?void 0:m[0])?void 0:x.status)?"Rejeitado":"Pendente"})]},e.id)}))}):t.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhum relatório recente"})]})]})]})}export{g as default};
