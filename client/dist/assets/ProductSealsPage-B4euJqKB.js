import{c as e,V as s,j as a,L as r,C as t,X as l,b as i,O as d,H as n,W as o,d as c,M as m,Y as x,P as u,N as h}from"./index-BwznawPq.js";import{r as p,i as g,e as j}from"./vendor-BDxjXY-2.js";import{s as b,S as y}from"./sealService-DLA3JCMh.js";import{T as N}from"./triangle-alert-lkz0R7qG.js";import{P as f}from"./plus-Dsd0IBz1.js";import{S as v}from"./shield-BctcVu_K.js";import{C as S}from"./calendar-Nt4fDNWr.js";import{L as w}from"./leaf-CjB26Q0j.js";import"./charts-C38Ohhsz.js";
/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=e("tree-pine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]),D=({product:e,onUpdate:n})=>{const[o,m]=p.useState([]),[x,u]=p.useState([]),[h,g]=p.useState(!0),[j,y]=p.useState(!1),[w,C]=p.useState(null),[D,k]=p.useState(null);p.useEffect((()=>{L()}),[e.id]);const L=async()=>{try{g(!0);const s=await b.getSeals({isActive:!0}),r=(null==s?void 0:s.seals)||[];r.length,u(r);try{const s=await b.getProductSeals({productId:e.id}),a=(null==s?void 0:s.productSeals)||[];m(a);const t=a.map((e=>e.sealId)),l=r.filter((e=>e.isRequired&&!t.includes(e.id))),i=a.filter((e=>e.expiryDate&&b.isSealExpired(e.expiryDate))),d=a.filter((e=>!("VERIFIED"!==e.status||e.expiryDate&&b.isSealExpired(e.expiryDate)))),n=0===l.length&&0===i.length;k({isCompliant:n,missingRequiredSeals:l,expiredSeals:i,validSeals:d,warnings:n?[]:["Produto não está em conformidade com todos os requisitos"]})}catch(a){m([]),k({isCompliant:!1,missingRequiredSeals:r.filter((e=>e.isRequired)),expiredSeals:[],validSeals:[],warnings:["Erro ao carregar selos do produto. Usando dados locais."]})}}catch(a){s.error("Erro ao carregar selos")}finally{g(!1)}};return h?a.jsx("div",{className:"flex justify-center items-center h-32",children:a.jsx(r,{size:"lg"})}):a.jsxs("div",{className:"space-y-6",children:[D&&a.jsxs("div",{className:"p-4 rounded-lg border "+(D.isCompliant?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[a.jsxs("div",{className:"flex items-center mb-2",children:[D.isCompliant?a.jsx(t,{className:"w-5 h-5 text-green-600 mr-2"}):a.jsx(N,{className:"w-5 h-5 text-red-600 mr-2"}),a.jsx("h3",{className:"font-semibold "+(D.isCompliant?"text-green-800":"text-red-800"),children:D.isCompliant?"Produto em Conformidade":"Produto Não Conforme"})]}),D.missingRequiredSeals.length>0&&a.jsxs("div",{className:"mb-2",children:[a.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Selos obrigatórios faltantes:"}),a.jsx("ul",{className:"text-sm text-red-600 ml-4",children:D.missingRequiredSeals.map((e=>a.jsxs("li",{children:["• ",e.name]},e.id)))})]}),D.expiredSeals.length>0&&a.jsxs("div",{className:"mb-2",children:[a.jsx("p",{className:"text-sm text-red-700 font-medium",children:"Selos expirados:"}),a.jsx("ul",{className:"text-sm text-red-600 ml-4",children:D.expiredSeals.map((e=>a.jsxs("li",{children:["• ",e.seal.name]},e.id)))})]}),D.warnings.length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-yellow-700 font-medium",children:"Avisos:"}),a.jsx("ul",{className:"text-sm text-yellow-600 ml-4",children:D.warnings.map(((e,s)=>a.jsxs("li",{children:["• ",e]},s)))})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Selos do Produto (",o.length,")"]}),a.jsxs("button",{onClick:()=>y(!0),className:"btn btn-primary flex items-center",children:[a.jsx(f,{className:"w-4 h-4 mr-2"}),"Adicionar Selo"]})]}),0===o.length?a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[a.jsx(v,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum selo adicionado"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Adicione selos para validar as claims do produto"}),a.jsx("button",{onClick:()=>y(!0),className:"btn btn-primary",children:"Adicionar Primeiro Selo"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map((e=>{const r=A(e.seal.category),o=(e=>{switch(e){case"VERIFIED":return t;case"PENDING":default:return c;case"EXPIRED":return N;case"INVALID":return l}})(e.status),m=I(e.seal.category),x=b.getSealStatusColor(e.status);return a.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`p-2 rounded-lg bg-${m}-100 mr-3`,children:a.jsx(r,{className:`w-5 h-5 text-${m}-600`})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:e.seal.name}),a.jsx("p",{className:"text-sm text-gray-600",children:e.seal.purpose})]})]}),a.jsx("button",{onClick:()=>(async e=>{var a;if(confirm("Tem certeza que deseja remover este selo?"))try{await b.removeProductSeal(e),await L(),s.success("Selo removido com sucesso!"),null==n||n()}catch(r){404===(null==(a=r.response)?void 0:a.status)?s.error("Selo não encontrado"):s.error("Erro ao remover selo. Tente novamente.")}})(e.id),className:"text-gray-400 hover:text-red-600 transition-colors",children:a.jsx(l,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(o,{className:`w-4 h-4 text-${x}-600 mr-1`}),a.jsx("span",{className:`text-sm font-medium text-${x}-600`,children:b.getSealStatusLabel(e.status)})]})]}),e.certificateNumber&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Certificado:"}),a.jsx("span",{className:"text-sm font-mono text-gray-900",children:e.certificateNumber})]}),e.expiryDate&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Expira em:"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(S,{className:"w-4 h-4 text-gray-400 mr-1"}),a.jsx("span",{className:"text-sm "+(b.isSealExpired(e.expiryDate)?"text-red-600 font-medium":"text-gray-900"),children:b.formatExpiryDate(e.expiryDate)})]})]}),e.validatingLaboratory&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Laboratório:"}),a.jsx("span",{className:"text-sm text-gray-900",children:e.validatingLaboratory})]}),e.documentUrl&&a.jsx("div",{className:"pt-2",children:a.jsxs("a",{href:e.documentUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-primary-600 hover:text-primary-700",children:[a.jsx(i,{className:"w-4 h-4 mr-1"}),"Ver Documento",a.jsx(d,{className:"w-3 h-3 ml-1"})]})})]})]},e.id)}))})]}),j&&a.jsx(E,{availableSeals:x,productSeals:o,onClose:()=>{y(!1),C(null)},onSelectSeal:C,onAddSeal:async a=>{var r,t,l,i;try{if(!w)return void s.error("Nenhum selo selecionado");const r={productId:e.id,sealId:w.id,certificateNumber:a.certificateNumber||void 0,issuedDate:a.issuedDate||void 0,expiryDate:a.expiryDate||void 0,validatingLaboratory:a.validatingLaboratory||void 0,documentUrl:a.documentUrl||void 0,notes:a.notes||void 0};await b.addProductSeal(r);await L(),y(!1),C(null),s.success("Selo adicionado com sucesso!"),null==n||n()}catch(d){if(400===(null==(r=d.response)?void 0:r.status)){const e=(null==(t=d.response.data)?void 0:t.error)||(null==(l=d.response.data)?void 0:l.message)||"Dados inválidos";s.error("string"==typeof e?e:"Dados inválidos")}else 404===(null==(i=d.response)?void 0:i.status)?s.error("Produto ou selo não encontrado"):s.error("Erro ao adicionar selo. Tente novamente.")}},selectedSeal:w})]})},E=({availableSeals:e,productSeals:s,onClose:r,onSelectSeal:t,onAddSeal:i,selectedSeal:d})=>{const[n,o]=p.useState({certificateNumber:"",issuedDate:"",expiryDate:"",validatingLaboratory:"",documentUrl:"",notes:""}),c=s.map((e=>e.sealId)),m=e.filter((e=>!c.includes(e.id)));return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Adicionar Selo"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx(l,{className:"w-5 h-5"})})]}),d?a.jsxs("form",{onSubmit:e=>{e.preventDefault(),d&&i(n)},className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:d.name}),a.jsx("p",{className:"text-sm text-gray-600",children:d.description})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número do Certificado"}),a.jsx("input",{type:"text",value:n.certificateNumber,onChange:e=>o({...n,certificateNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: ABC123456"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Emissão"}),a.jsx("input",{type:"date",value:n.issuedDate,onChange:e=>o({...n,issuedDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Expiração"}),a.jsx("input",{type:"date",value:n.expiryDate,onChange:e=>o({...n,expiryDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Laboratório Validador"}),a.jsx("input",{type:"text",value:n.validatingLaboratory,onChange:e=>o({...n,validatingLaboratory:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Nome do laboratório"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do Documento"}),a.jsx("input",{type:"url",value:n.documentUrl,onChange:e=>o({...n,documentUrl:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"https://..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),a.jsx("textarea",{value:n.notes,onChange:e=>o({...n,notes:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Observações adicionais..."})]}),a.jsxs("div",{className:"flex space-x-3 pt-4",children:[a.jsx("button",{type:"submit",className:"flex-1 btn btn-primary",children:"Adicionar Selo"}),a.jsx("button",{type:"button",onClick:()=>t(null),className:"btn btn-outline",children:"Voltar"})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecione um selo para adicionar ao produto:"}),0===m.length?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("p",{className:"text-gray-500",children:"Nenhum selo disponível para adicionar"}),a.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Total de selos: ",e.length," | Filtrados: ",m.length]})]}):null,m.map((e=>{const s=A(e.category),r=I(e.category);return a.jsx("button",{onClick:()=>t(e),className:"w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`p-2 rounded-lg bg-${r}-100 mr-3`,children:a.jsx(s,{className:`w-4 h-4 text-${r}-600`})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),a.jsx("p",{className:"text-sm text-gray-600",children:e.purpose}),e.isRequired&&a.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-red-100 text-red-800 rounded mt-1",children:"Obrigatório"})]})]})},e.id)}))]})]})})},A=e=>{switch(e){case"REGULATORY":default:return v;case"QUALITY":return o;case"ORGANIC":return w;case"ETHICAL":return n;case"ENVIRONMENTAL":return C}},I=e=>{const s=y.find((s=>s.id===e));return(null==s?void 0:s.color)||"gray"},k=()=>{const{productId:e}=g(),s=j(),[t,l]=p.useState(null),[i,d]=p.useState(!0);p.useEffect((()=>{e&&n()}),[e]);const n=async()=>{if(e)try{d(!0);const s=await m.getProduct(e);l(s.product)}catch(a){x.error(`Erro ao carregar produto: ${a.message||"Erro desconhecido"}`),s("/dashboard/products")}finally{d(!1)}};return i?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(r,{size:"lg"})}):t?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("button",{onClick:()=>s("/dashboard/products"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(h,{className:"w-5 h-5"})}),a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(v,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Selos e Certificações"}),a.jsxs("p",{className:"text-gray-600",children:[t.name," - ",t.brand]})]})]})})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:a.jsxs("div",{className:"flex items-start space-x-4",children:[t.imageUrl&&a.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-20 h-20 rounded-lg object-cover"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:t.name}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Marca:"}),a.jsx("span",{className:"ml-2 font-medium text-gray-900",children:t.brand})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Categoria:"}),a.jsx("span",{className:"ml-2 font-medium text-gray-900",children:t.category})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"SKU:"}),a.jsx("span",{className:"ml-2 font-mono text-gray-900",children:t.sku})]})]}),t.description&&a.jsx("p",{className:"mt-3 text-gray-600",children:t.description}),(()=>{const e=(s=t.claims)?Array.isArray(s)?s:"string"==typeof s?s.split(",").map((e=>e.trim())).filter((e=>e.length>0)):[]:[];var s;return e.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx("span",{className:"text-gray-600",children:"Claims:"}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:e.map(((e,s)=>a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e},s)))})]})})()]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:a.jsx(D,{product:t,onUpdate:n})}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(v,{className:"w-6 h-6 text-blue-600 mr-3 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Sobre Selos e Certificações"}),a.jsxs("div",{className:"text-blue-800 space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Selos Obrigatórios:"})," São exigidos por lei para comercialização do produto (ex: ANVISA, SIF)."]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Selos de Qualidade:"})," Certificam processos e padrões de qualidade (ex: ISO 22000, HACCP)."]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Selos Orgânicos:"})," Validam produção orgânica e natural (ex: Orgânico Brasil, IBD)."]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Selos Éticos:"})," Garantem práticas éticas e responsáveis (ex: Vegano, Fair Trade)."]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Selos Ambientais:"})," Certificam sustentabilidade e responsabilidade ambiental (ex: Eureciclo, Carbono Neutro)."]})]})]})]})})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(u,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Produto não encontrado"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"O produto solicitado não foi encontrado."}),a.jsx("button",{onClick:()=>s("/dashboard/products"),className:"btn btn-primary",children:"Voltar para Produtos"})]})};export{k as default};
