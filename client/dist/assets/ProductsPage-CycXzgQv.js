var e,s,t,a,i,r,l,n,o,c,d,h,u,m,p,x,f,v,j,g,y,N,w,b,C,R,k=e=>{throw TypeError(e)},A=(e,s,t)=>s.has(e)||k("Cannot "+t),S=(e,s,t)=>(A(e,s,"read from private field"),t?t.call(e):s.get(e)),P=(e,s,t)=>s.has(e)?k("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,t),E=(e,s,t,a)=>(A(e,s,"write to private field"),a?a.call(e,t):s.set(e,t),t),M=(e,s,t)=>(A(e,s,"access private method"),t);import{k as O,p as D,r as I,s as V,l as Q,n as T,m as U,o as q,t as W,q as F,v as L,w as _,x as B,y as $,z,c as G,j as H,A as K,B as J,f as X,Q as Y,C as Z,e as ee,E as se,G as te,u as ae,I as ie,J as re,K as le,M as ne}from"./index--pVY8JWu.js";import{r as oe,L as ce,e as de}from"./vendor-BDxjXY-2.js";import{v as he}from"./validationService-NvwJQYBM.js";import{E as ue}from"./eye-BwaTJlPp.js";import{S as me}from"./square-pen-DyGEqmGt.js";import{S as pe}from"./shield-CfWOCZ2j.js";import{M as xe}from"./map-pin-8-dTDqOl.js";import{P as fe}from"./Pagination-CiHTI6Lu.js";import{S as ve}from"./search-HjzIlawk.js";import{P as je}from"./plus-CGEZeKeG.js";import{F as ge}from"./funnel-Cfq3C2Ol.js";import"./charts-C38Ohhsz.js";import"./fallbackService-D-6NybDe.js";import"./qrService-DE6BdSVq.js";var ye=(R=class extends O{constructor(f,v){super(),P(this,x),P(this,e),P(this,s),P(this,t),P(this,a),P(this,i),P(this,r),P(this,l),P(this,n),P(this,o),P(this,c),P(this,d),P(this,h),P(this,u),P(this,m),P(this,p,new Set),this.options=v,E(this,e,f),E(this,n,null),E(this,l,D()),this.options.experimental_prefetchInRender||S(this,l).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(v)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(S(this,s).addObserver(this),Ne(S(this,s),this.options)?M(this,x,f).call(this):this.updateResult(),M(this,x,y).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return we(S(this,s),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return we(S(this,s),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,M(this,x,N).call(this),M(this,x,w).call(this),S(this,s).removeObserver(this)}setOptions(t){const a=this.options,i=S(this,s);if(this.options=S(this,e).defaultQueryOptions(t),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof I(this.options.enabled,S(this,s)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");M(this,x,b).call(this),S(this,s).setOptions(this.options),a._defaulted&&!V(this.options,a)&&S(this,e).getQueryCache().notify({type:"observerOptionsUpdated",query:S(this,s),observer:this});const r=this.hasListeners();r&&be(S(this,s),i,this.options,a)&&M(this,x,f).call(this),this.updateResult(),!r||S(this,s)===i&&I(this.options.enabled,S(this,s))===I(a.enabled,S(this,s))&&Q(this.options.staleTime,S(this,s))===Q(a.staleTime,S(this,s))||M(this,x,v).call(this);const l=M(this,x,j).call(this);!r||S(this,s)===i&&I(this.options.enabled,S(this,s))===I(a.enabled,S(this,s))&&l===S(this,m)||M(this,x,g).call(this,l)}getOptimisticResult(t){const l=S(this,e).getQueryCache().build(S(this,e),t),n=this.createResult(l,t);return function(e,s){if(!V(e.getCurrentResult(),s))return!0;return!1}(this,n)&&(E(this,a,n),E(this,r,this.options),E(this,i,S(this,s).state)),n}getCurrentResult(){return S(this,a)}trackResult(e,s){return new Proxy(e,{get:(e,t)=>(this.trackProp(t),null==s||s(t),Reflect.get(e,t))})}trackProp(e){S(this,p).add(e)}getCurrentQuery(){return S(this,s)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(s){const t=S(this,e).defaultQueryOptions(s),a=S(this,e).getQueryCache().build(S(this,e),t);return a.fetch().then((()=>this.createResult(a,t)))}fetch(e){return M(this,x,f).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then((()=>(this.updateResult(),S(this,a))))}createResult(e,h){var u;const m=S(this,s),p=this.options,x=S(this,a),f=S(this,i),v=S(this,r),j=e!==m?e.state:S(this,t),{state:g}=e;let y,N={...g},w=!1;if(h._optimisticResults){const s=this.hasListeners(),t=!s&&Ne(e,h),a=s&&be(e,m,h,p);(t||a)&&(N={...N,...L(g.data,e.options)}),"isRestoring"===h._optimisticResults&&(N.fetchStatus="idle")}let{error:b,errorUpdatedAt:C,status:R}=N;y=N.data;let k=!1;if(void 0!==h.placeholderData&&void 0===y&&"pending"===R){let e;(null==x?void 0:x.isPlaceholderData)&&h.placeholderData===(null==v?void 0:v.placeholderData)?(e=x.data,k=!0):e="function"==typeof h.placeholderData?h.placeholderData(null==(u=S(this,d))?void 0:u.state.data,S(this,d)):h.placeholderData,void 0!==e&&(R="success",y=_(null==x?void 0:x.data,e,h),w=!0)}if(h.select&&void 0!==y&&!k)if(x&&y===(null==f?void 0:f.data)&&h.select===S(this,o))y=S(this,c);else try{E(this,o,h.select),y=h.select(y),y=_(null==x?void 0:x.data,y,h),E(this,c,y),E(this,n,null)}catch(Q){E(this,n,Q)}S(this,n)&&(b=S(this,n),y=S(this,c),C=Date.now(),R="error");const A="fetching"===N.fetchStatus,P="pending"===R,M="error"===R,O=P&&A,I=void 0!==y,V={status:R,fetchStatus:N.fetchStatus,isPending:P,isSuccess:"success"===R,isError:M,isInitialLoading:O,isLoading:O,data:y,dataUpdatedAt:N.dataUpdatedAt,error:b,errorUpdatedAt:C,failureCount:N.fetchFailureCount,failureReason:N.fetchFailureReason,errorUpdateCount:N.errorUpdateCount,isFetched:N.dataUpdateCount>0||N.errorUpdateCount>0,isFetchedAfterMount:N.dataUpdateCount>j.dataUpdateCount||N.errorUpdateCount>j.errorUpdateCount,isFetching:A,isRefetching:A&&!P,isLoadingError:M&&!I,isPaused:"paused"===N.fetchStatus,isPlaceholderData:w,isRefetchError:M&&I,isStale:Ce(e,h),refetch:this.refetch,promise:S(this,l)};if(this.options.experimental_prefetchInRender){const s=e=>{"error"===V.status?e.reject(V.error):void 0!==V.data&&e.resolve(V.data)},t=()=>{const e=E(this,l,V.promise=D());s(e)},a=S(this,l);switch(a.status){case"pending":e.queryHash===m.queryHash&&s(a);break;case"fulfilled":"error"!==V.status&&V.data===a.value||t();break;case"rejected":"error"===V.status&&V.error===a.reason||t()}}return V}updateResult(){const e=S(this,a),t=this.createResult(S(this,s),this.options);if(E(this,i,S(this,s).state),E(this,r,this.options),void 0!==S(this,i).data&&E(this,d,S(this,s)),V(t,e))return;E(this,a,t);M(this,x,C).call(this,{listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:s}=this.options,t="function"==typeof s?s():s;if("all"===t||!t&&!S(this,p).size)return!0;const i=new Set(t??S(this,p));return this.options.throwOnError&&i.add("error"),Object.keys(S(this,a)).some((s=>{const t=s;return S(this,a)[t]!==e[t]&&i.has(t)}))})()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&M(this,x,y).call(this)}},e=new WeakMap,s=new WeakMap,t=new WeakMap,a=new WeakMap,i=new WeakMap,r=new WeakMap,l=new WeakMap,n=new WeakMap,o=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,u=new WeakMap,m=new WeakMap,p=new WeakMap,x=new WeakSet,f=function(e){M(this,x,b).call(this);let t=S(this,s).fetch(this.options,e);return(null==e?void 0:e.throwOnError)||(t=t.catch(T)),t},v=function(){M(this,x,N).call(this);const e=Q(this.options.staleTime,S(this,s));if(U||S(this,a).isStale||!q(e))return;const t=W(S(this,a).dataUpdatedAt,e);E(this,h,setTimeout((()=>{S(this,a).isStale||this.updateResult()}),t+1))},j=function(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(S(this,s)):this.options.refetchInterval)??!1},g=function(e){M(this,x,w).call(this),E(this,m,e),!U&&!1!==I(this.options.enabled,S(this,s))&&q(S(this,m))&&0!==S(this,m)&&E(this,u,setInterval((()=>{(this.options.refetchIntervalInBackground||F.isFocused())&&M(this,x,f).call(this)}),S(this,m)))},y=function(){M(this,x,v).call(this),M(this,x,g).call(this,M(this,x,j).call(this))},N=function(){S(this,h)&&(clearTimeout(S(this,h)),E(this,h,void 0))},w=function(){S(this,u)&&(clearInterval(S(this,u)),E(this,u,void 0))},b=function(){const a=S(this,e).getQueryCache().build(S(this,e),this.options);if(a===S(this,s))return;const i=S(this,s);E(this,s,a),E(this,t,a.state),this.hasListeners()&&(null==i||i.removeObserver(this),a.addObserver(this))},C=function(t){B.batch((()=>{t.listeners&&this.listeners.forEach((e=>{e(S(this,a))})),S(this,e).getQueryCache().notify({query:S(this,s),type:"observerResultsUpdated"})}))},R);function Ne(e,s){return function(e,s){return!1!==I(s.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===s.retryOnMount)}(e,s)||void 0!==e.state.data&&we(e,s,s.refetchOnMount)}function we(e,s,t){if(!1!==I(s.enabled,e)&&"static"!==Q(s.staleTime,e)){const a="function"==typeof t?t(e):t;return"always"===a||!1!==a&&Ce(e,s)}return!1}function be(e,s,t,a){return(e!==s||!1===I(a.enabled,e))&&(!t.suspense||"error"!==e.state.status)&&Ce(e,t)}function Ce(e,s){return!1!==I(s.enabled,e)&&e.isStaleByTime(Q(s.staleTime,e))}var Re=oe.createContext(!1);Re.Provider;var ke=oe.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),Ae=(e,s,t)=>s.fetchOptimistic(e).catch((()=>{t.clearReset()}));function Se(e,s,t){var a,i,r,l,n;const o=oe.useContext(Re),c=oe.useContext(ke),d=z(),h=d.defaultQueryOptions(e);null==(i=null==(a=d.getDefaultOptions().queries)?void 0:a._experimental_beforeQuery)||i.call(a,h),h._optimisticResults=o?"isRestoring":"optimistic",(e=>{if(e.suspense){const s=e=>"static"===e?e:Math.max(e??1e3,1e3),t=e.staleTime;e.staleTime="function"==typeof t?(...e)=>s(t(...e)):s(t),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3))}})(h),((e,s)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(s.isReset()||(e.retryOnMount=!1))})(h,c),(e=>{oe.useEffect((()=>{e.clearReset()}),[e])})(c);const u=!d.getQueryCache().get(h.queryHash),[m]=oe.useState((()=>new s(d,h))),p=m.getOptimisticResult(h),x=!o&&!1!==e.subscribed;if(oe.useSyncExternalStore(oe.useCallback((e=>{const s=x?m.subscribe(B.batchCalls(e)):T;return m.updateResult(),s}),[m,x]),(()=>m.getCurrentResult()),(()=>m.getCurrentResult())),oe.useEffect((()=>{m.setOptions(h)}),[h,m]),((e,s)=>(null==e?void 0:e.suspense)&&s.isPending)(h,p))throw Ae(h,m,c);if((({result:e,errorResetBoundary:s,throwOnError:t,query:a,suspense:i})=>e.isError&&!s.isReset()&&!e.isFetching&&a&&(i&&void 0===e.data||$(t,[e.error,a])))({result:p,errorResetBoundary:c,throwOnError:h.throwOnError,query:d.getQueryCache().get(h.queryHash),suspense:h.suspense}))throw p.error;if(null==(l=null==(r=d.getDefaultOptions().queries)?void 0:r._experimental_afterQuery)||l.call(r,h,p),h.experimental_prefetchInRender&&!U&&((e,s)=>e.isLoading&&e.isFetching&&!s)(p,o)){const e=u?Ae(h,m,c):null==(n=d.getQueryCache().get(h.queryHash))?void 0:n.promise;null==e||e.catch(T).finally((()=>{m.updateResult()}))}return h.notifyOnChangeProps?p:m.trackResult(p)}function Pe(e,s){return Se(e,ye)}
/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=G("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Me=G("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Oe=G("inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]),De=oe.memo((({product:e,userRole:s,onQRCodeClick:t,onValidateClick:a})=>{const i="BRAND"===s||"ADMIN"===s;return H.jsxs("tr",{className:"hover:bg-gray-50",children:[H.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:H.jsxs("div",{className:"flex items-center",children:[e.imageUrl&&H.jsx("img",{className:"h-10 w-10 rounded-lg object-cover mr-3",src:e.imageUrl,alt:e.name,loading:"lazy"}),H.jsxs("div",{children:[H.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),H.jsxs("div",{className:"text-sm text-gray-500",children:[e.brand," • SKU: ",e.sku]})]})]})}),H.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.category}),H.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:H.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${J(e.status)}`,children:K(e.status)})}),H.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:X(e.createdAt)}),H.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:H.jsxs("div",{className:"flex items-center space-x-2",children:[H.jsx(ce,{to:`/dashboard/products/${e.id}`,className:"text-primary-600 hover:text-primary-900",title:"Ver detalhes",children:H.jsx(ue,{className:"h-4 w-4"})}),i&&H.jsxs(H.Fragment,{children:[H.jsx(ce,{to:`/dashboard/products/${e.id}/edit`,className:"text-gray-600 hover:text-gray-900",title:"Editar",children:H.jsx(me,{className:"h-4 w-4"})}),H.jsx("button",{onClick:()=>t(e),className:"text-green-600 hover:text-green-900",title:e.qrCode?"Ver QR Code":"Gerar QR Code",children:H.jsx(Y,{className:"h-4 w-4"})}),H.jsx(ce,{to:`/dashboard/products/${e.id}/seals`,className:"text-blue-600 hover:text-blue-900",title:"Gerenciar Selos",onClick:e=>{},children:H.jsx(pe,{className:"h-4 w-4"})}),H.jsx(ce,{to:`/dashboard/products/${e.id}/traceability`,className:"text-purple-600 hover:text-purple-900",title:"Rastreabilidade",children:H.jsx(xe,{className:"h-4 w-4"})}),"APPROVED"!==e.status&&"VALIDATED"!==e.status&&a&&H.jsx("button",{onClick:()=>a(e),className:"text-orange-600 hover:text-orange-900",title:"Solicitar Validação",children:H.jsx(Z,{className:"h-4 w-4"})}),e.qrCode&&H.jsx(ce,{to:`/dashboard/qr-analytics/${e.id}`,className:"text-blue-600 hover:text-blue-900",title:"Analytics do QR Code",children:H.jsx(ee,{className:"h-4 w-4"})})]}),H.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:H.jsx(Me,{className:"h-4 w-4"})})]})})]})}));De.displayName="ProductRow";const Ie=oe.memo((({product:e,userRole:s,onQRCodeClick:t,onValidateClick:a})=>{const i="BRAND"===s||"ADMIN"===s;return H.jsxs("div",{className:"card-hover border-b border-neutral-200 p-4 transition-all duration-200 ease-in-out hover:bg-neutral-50",children:[H.jsxs("div",{className:"flex items-start justify-between",children:[H.jsxs("div",{className:"flex items-center flex-1",children:[e.imageUrl&&H.jsx("img",{className:"h-12 w-12 rounded-lg object-cover mr-3 flex-shrink-0 transition-transform duration-200 hover:scale-105",src:e.imageUrl,alt:e.name,loading:"lazy"}),H.jsxs("div",{className:"flex-1 min-w-0",children:[H.jsx("h3",{className:"text-sm font-medium text-neutral-900 truncate",children:e.name}),H.jsx("p",{className:"text-sm text-neutral-500 truncate",children:e.brand}),H.jsxs("p",{className:"text-xs text-neutral-400",children:["SKU: ",e.sku]})]})]}),H.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[H.jsx(ce,{to:`/dashboard/products/${e.id}`,className:"icon-btn text-primary-600 hover:text-primary-700",title:"Ver detalhes",children:H.jsx(ue,{className:"h-4 w-4"})}),i&&H.jsxs(H.Fragment,{children:[H.jsx("button",{onClick:()=>t(e),className:"icon-btn text-success-600 hover:text-success-700",title:e.qrCode?"Ver QR Code":"Gerar QR Code",children:H.jsx(Y,{className:"h-4 w-4"})}),H.jsx(ce,{to:`/dashboard/products/${e.id}/seals`,className:"icon-btn text-info-600 hover:text-info-700",title:"Gerenciar Selos",children:H.jsx(pe,{className:"h-4 w-4"})}),"VALIDATED"!==e.status&&a&&H.jsx("button",{onClick:()=>a(e),className:"icon-btn text-warning-600 hover:text-warning-700",title:"Solicitar Validação",children:H.jsx(Z,{className:"h-4 w-4"})})]})]})]}),H.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[H.jsxs("div",{className:"flex items-center space-x-4",children:[H.jsx("span",{className:`badge ${J(e.status).replace("bg-","badge-").split(" ")[0]}`,children:K(e.status)}),H.jsx("span",{className:"text-xs text-neutral-500",children:e.category})]}),H.jsx("span",{className:"text-xs text-neutral-400",children:X(e.createdAt)})]})]})}));Ie.displayName="ProductCard";const Ve=({className:e,width:s,height:t})=>H.jsx("div",{className:se("animate-pulse bg-gray-200 dark:bg-gray-700 rounded",e),style:{width:s,height:t}}),Qe=({variant:e="card",count:s=1,className:t})=>{const a=()=>{switch(e){case"card":return H.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 space-y-4",children:[H.jsxs("div",{className:"flex items-center space-x-4",children:[H.jsx(Ve,{className:"h-12 w-12 rounded-full"}),H.jsxs("div",{className:"flex-1 space-y-2",children:[H.jsx(Ve,{className:"h-4 w-3/4"}),H.jsx(Ve,{className:"h-3 w-1/2"})]})]}),H.jsx(Ve,{className:"h-20 w-full"}),H.jsxs("div",{className:"flex justify-between",children:[H.jsx(Ve,{className:"h-8 w-24"}),H.jsx(Ve,{className:"h-8 w-24"})]})]});case"list":return H.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:H.jsxs("div",{className:"flex items-center space-x-4",children:[H.jsx(Ve,{className:"h-10 w-10 rounded"}),H.jsxs("div",{className:"flex-1 space-y-2",children:[H.jsx(Ve,{className:"h-4 w-2/3"}),H.jsx(Ve,{className:"h-3 w-1/3"})]}),H.jsx(Ve,{className:"h-8 w-20"})]})});case"table":return H.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[H.jsx("div",{className:"p-4 border-b",children:H.jsx(Ve,{className:"h-8 w-full"})}),Array.from({length:5}).map(((e,s)=>H.jsxs("div",{className:"p-4 border-b flex items-center space-x-4",children:[H.jsx(Ve,{className:"h-4 w-8"}),H.jsx(Ve,{className:"h-4 flex-1"}),H.jsx(Ve,{className:"h-4 w-24"}),H.jsx(Ve,{className:"h-4 w-24"}),H.jsx(Ve,{className:"h-8 w-20"})]},s)))]});case"form":return H.jsxs("div",{className:"space-y-6",children:[H.jsxs("div",{className:"space-y-2",children:[H.jsx(Ve,{className:"h-4 w-24"}),H.jsx(Ve,{className:"h-10 w-full"})]}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(Ve,{className:"h-4 w-32"}),H.jsx(Ve,{className:"h-10 w-full"})]}),H.jsxs("div",{className:"space-y-2",children:[H.jsx(Ve,{className:"h-4 w-28"}),H.jsx(Ve,{className:"h-24 w-full"})]}),H.jsx(Ve,{className:"h-10 w-32"})]});case"page":return H.jsxs("div",{className:"space-y-6",children:[H.jsx(Ve,{className:"h-8 w-64"}),H.jsx(Ve,{className:"h-4 w-96"}),H.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map(((e,s)=>H.jsx("div",{children:i()},s)))})]});case"inline":return H.jsx(Ve,{className:"h-4 w-24 inline-block"});default:return null}},i=()=>H.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 space-y-4",children:[H.jsxs("div",{className:"flex items-center space-x-4",children:[H.jsx(Ve,{className:"h-12 w-12 rounded-full"}),H.jsxs("div",{className:"flex-1 space-y-2",children:[H.jsx(Ve,{className:"h-4 w-3/4"}),H.jsx(Ve,{className:"h-3 w-1/2"})]})]}),H.jsx(Ve,{className:"h-20 w-full"}),H.jsxs("div",{className:"flex justify-between",children:[H.jsx(Ve,{className:"h-8 w-24"}),H.jsx(Ve,{className:"h-8 w-24"})]})]});return s>1&&"page"!==e&&"inline"!==e?H.jsx("div",{className:se("space-y-4",t),children:Array.from({length:s}).map(((e,s)=>H.jsx("div",{children:a()},s)))}):H.jsx("div",{className:t,children:a()})},Te=({variant:e="default",icon:s,title:t,description:a,action:i,secondaryAction:r,className:l})=>{const n=s||{default:Oe,search:ve,error:te,"no-data":Ee,"no-access":te}[e],o=(e,s=!0)=>{if(!e)return null;const t=se("inline-flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors",s?"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500");return e.href?H.jsx(ce,{to:e.href,className:t,children:e.label}):H.jsx("button",{onClick:e.onClick,className:t,children:e.label})};return H.jsx("div",{className:se("text-center py-12",l),children:H.jsxs("div",{className:"mx-auto max-w-md",children:[H.jsx(n,{className:"mx-auto h-12 w-12 text-gray-400"}),H.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:t}),a&&H.jsx("p",{className:"mt-2 text-sm text-gray-500",children:a}),(i||r)&&H.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-center",children:[o(i,!0),o(r,!1)]})]})})},Ue=({onRetry:e,message:s})=>H.jsx(Te,{variant:"error",title:"Something went wrong",description:s||"We encountered an error loading this content. Please try again.",action:e?{label:"Try Again",onClick:e}:void 0}),qe=({loading:e,error:s,empty:t,loadingVariant:a="card",loadingCount:i=3,emptyTitle:r="No data found",emptyDescription:l,emptyAction:n,onRetry:o,children:c,className:d})=>{if(e)return H.jsx("div",{className:d,children:H.jsx(Qe,{variant:a,count:i})});if(s){const e="string"==typeof s?s:s.message||"An error occurred";return H.jsx("div",{className:d,children:H.jsx(Ue,{message:e,onRetry:o})})}return t?H.jsx("div",{className:d,children:H.jsx(Te,{title:r,description:l,action:n})}):H.jsx("div",{className:d,children:c})},We=()=>{const{user:e}=ae(),{openModal:s}=ie(),t=z(),a=de(),[i,r]=oe.useState(""),[l,n]=oe.useState(""),[o,c]=oe.useState(""),[d,h]=oe.useState(""),[u,m]=oe.useState(1),p=oe.useMemo((()=>re((e=>{n(e),m(1)}),300)),[]),x=oe.useCallback((e=>{s(e.id,e.name)}),[s]),f=oe.useCallback((async e=>{var s,i,r,l,n,o;try{const s=await he.getValidations({productId:e.id,page:1,limit:1});if(s.data&&s.data.length>0){const e=s.data[0];return le.info("Redirecionando para a validação existente..."),void a(`/dashboard/validations/${e.id}/review`)}await he.createValidation({productId:e.id,type:"MANUAL",status:"PENDING",claimsValidated:{},summary:"Validação manual solicitada",notes:"Validação solicitada através da interface de produtos"});le.success("Validação solicitada com sucesso!"),t.invalidateQueries({queryKey:["products"]})}catch(c){if(409===(null==(s=null==c?void 0:c.response)?void 0:s.status)){const e=c.response.data;(null==(i=null==e?void 0:e.message)?void 0:i.includes("already exists"))?le.error('Este produto já possui uma validação. Acesse a seção "Validações" para visualizar ou atualizar.'):le.error("Validação já existe para este produto")}else if(400===(null==(r=null==c?void 0:c.response)?void 0:r.status)){const e=c.response.data;le.error((null==e?void 0:e.message)||"Dados inválidos para validação")}else if(404===(null==(l=null==c?void 0:c.response)?void 0:l.status))le.error("Produto não encontrado");else{const e=(null==(o=null==(n=null==c?void 0:c.response)?void 0:n.data)?void 0:o.message)||(null==c?void 0:c.message)||"Erro ao solicitar validação";le.error(e)}}}),[t,a]),v=oe.useCallback((e=>{const s=e.target.value;r(s),p(s)}),[p]),j=oe.useCallback((e=>{c(e.target.value),m(1)}),[]),g=oe.useCallback((e=>{h(e.target.value),m(1)}),[]),{data:y,isLoading:N,error:w}=Pe({queryKey:["products",{search:l,category:o,status:d,page:u}],queryFn:()=>ne.getProducts({search:l,category:o,status:d,page:u,limit:10})}),{data:b}=Pe({queryKey:["categories"],queryFn:ne.getCategories}),C=(null==y?void 0:y.data)||[],R=null==y?void 0:y.pagination;return H.jsxs("div",{className:"space-y-6",children:[H.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[H.jsxs("div",{children:[H.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Produtos"}),H.jsx("p",{className:"text-gray-600",children:"Gerencie seus produtos e validações"})]}),("BRAND"===(null==e?void 0:e.role)||"ADMIN"===(null==e?void 0:e.role))&&H.jsxs(ce,{to:"/dashboard/products/new",className:"btn-primary flex items-center mt-4 sm:mt-0",children:[H.jsx(je,{className:"h-4 w-4 mr-2"}),"Novo Produto"]})]}),H.jsx("div",{className:"card p-4",children:H.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[H.jsxs("div",{className:"relative",children:[H.jsx(ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400 pointer-events-none"}),H.jsx("input",{type:"text",placeholder:"Buscar produtos...",value:i,onChange:v,className:"input pl-10"})]}),H.jsxs("select",{value:o,onChange:j,className:"select",children:[H.jsx("option",{value:"",children:"Todas as categorias"}),null==b?void 0:b.map((e=>H.jsx("option",{value:e,children:e},e)))]}),H.jsxs("select",{value:d,onChange:g,className:"select",children:[H.jsx("option",{value:"",children:"Todos os status"}),H.jsx("option",{value:"DRAFT",children:"Rascunho"}),H.jsx("option",{value:"PENDING",children:"Pendente"}),H.jsx("option",{value:"VALIDATED",children:"Validado"}),H.jsx("option",{value:"REJECTED",children:"Rejeitado"}),H.jsx("option",{value:"EXPIRED",children:"Expirado"})]}),H.jsxs("button",{className:"btn-outline flex items-center justify-center",children:[H.jsx(ge,{className:"h-4 w-4 mr-2"}),"Filtros"]})]})}),H.jsx(qe,{loading:N,error:w,empty:0===C.length,loadingVariant:"list",loadingCount:5,emptyTitle:i||o||d?"Nenhum produto encontrado":"Nenhum produto cadastrado",emptyDescription:i||o||d?"Tente ajustar os filtros de busca.":"Comece cadastrando seu primeiro produto.",emptyAction:"BRAND"!==(null==e?void 0:e.role)&&"ADMIN"!==(null==e?void 0:e.role)||i||o||d?void 0:{label:"Cadastrar Produto",onClick:()=>a("/dashboard/products/new")},children:C.length>0&&H.jsxs("div",{className:"card overflow-hidden",children:[H.jsx("div",{className:"hidden md:block overflow-x-auto",children:H.jsxs("table",{className:"min-w-full divide-y divide-neutral-200",children:[H.jsx("thead",{className:"bg-neutral-50",children:H.jsxs("tr",{children:[H.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Produto"}),H.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoria"}),H.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),H.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criado em"}),H.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),H.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map((s=>H.jsx(De,{product:s,userRole:null==e?void 0:e.role,onQRCodeClick:x,onValidateClick:f},s.id)))})]})}),H.jsx("div",{className:"md:hidden",children:C.map((s=>H.jsx(Ie,{product:s,userRole:null==e?void 0:e.role,onQRCodeClick:x,onValidateClick:f},s.id)))}),R&&R.totalPages>1&&H.jsx(fe,{currentPage:u,totalPages:R.totalPages,totalItems:R.total,itemsPerPage:R.limit,onPageChange:m})]})})]})};export{We as default};
