import{j as e,V as s,U as a}from"./index-BwznawPq.js";import{r as l}from"./vendor-BDxjXY-2.js";import"./charts-C38Ohhsz.js";const t=()=>{var t,r;const[d,i]=l.useState(null),[o,n]=l.useState(!1),[c]=l.useState("04aa9c1a-c7c2-48a9-84ce-560e50914dfe");return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"🧪 Teste de QR Code"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Controles de Teste"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product ID"}),e.jsx("input",{type:"text",value:c,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:async()=>{try{n(!0);const e=await a.post("/qr/generate",{productId:c});i(e.data),s.success("QR Code gerado com sucesso!")}catch(e){s.error("Erro ao gerar QR Code")}finally{n(!1)}},disabled:o,className:"w-full btn btn-primary",children:o?"⏳ Gerando...":"🔄 Gerar QR (Axios)"}),e.jsx("button",{onClick:async()=>{var e;try{n(!0);const a=localStorage.getItem("auth-storage"),l=a?JSON.parse(a):null,t=null==(e=null==l?void 0:l.state)?void 0:e.token,r=await fetch("http://localhost:3000/api/qr/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({productId:c})});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const d=await r.json();i(d),s.success("QR Code gerado via API direta!")}catch(a){s.error("Erro na API direta")}finally{n(!1)}},disabled:o,className:"w-full btn btn-outline",children:o?"⏳ Testando...":"🔗 Testar API Direta (Fetch)"}),e.jsx("button",{onClick:()=>{i(null),s.success("Dados limpos")},className:"w-full btn btn-outline",children:"🗑️ Limpar Dados"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Resultado"}),d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block p-4 bg-gray-50 border rounded-lg",children:e.jsx("img",{src:d.qrCodeImage,alt:"QR Code",className:"w-32 h-32 mx-auto",onError:e=>{e.currentTarget.style.display="none"},onLoad:()=>{}})}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Código: ",d.qrCode]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"QR Code"}),e.jsx("p",{className:"text-sm font-mono bg-gray-50 p-2 rounded",children:d.qrCode})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"URL de Validação"}),e.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded break-all",children:d.validationUrl})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Produto"}),e.jsxs("p",{className:"text-sm bg-gray-50 p-2 rounded",children:[null==(t=d.product)?void 0:t.name," (",null==(r=d.product)?void 0:r.brand,")"]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(d.validationUrl),s.success("URL copiada!")},className:"flex-1 btn btn-outline btn-sm",children:"📋 Copiar URL"}),e.jsx("button",{onClick:()=>{window.open(d.validationUrl,"_blank")},className:"flex-1 btn btn-outline btn-sm",children:"🔗 Abrir URL"})]})]}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📱"}),e.jsx("p",{children:"Nenhum QR Code gerado ainda"})]})]})]}),e.jsxs("div",{className:"mt-6 bg-gray-100 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"📋 Debug Info:"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsx("li",{children:"• Abra o console do navegador para ver logs detalhados"}),e.jsx("li",{children:"• Teste primeiro com Axios (usa interceptor)"}),e.jsx("li",{children:"• Teste depois com Fetch (API direta)"}),e.jsx("li",{children:"• Verifique se a imagem do QR Code carrega"}),e.jsx("li",{children:"• Teste a URL de validação"})]})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("div",{className:"mt-2 text-sm",children:"Processando..."})]})})]})};export{t as default};
