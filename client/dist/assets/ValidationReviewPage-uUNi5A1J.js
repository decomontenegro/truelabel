import{c as e,j as s,C as a,K as t,X as l,a0 as r,S as i,d,O as n,u as c,J as x}from"./index-DeKtUJAc.js";import{r as m,i as o,e as h}from"./vendor-BDxjXY-2.js";import{v as u}from"./validationService-DFgyIoZu.js";import{B as g}from"./bot-BfCmKRaZ.js";import{C as j}from"./chart-no-axes-column-increasing-qMxXgcom.js";import{T as N}from"./triangle-alert-CiFJGrB3.js";import{S as p}from"./save-DAYOlFoS.js";import"./charts-C38Ohhsz.js";import"./fallbackService-D-6NybDe.js";import"./qrService-BZ_OVWnh.js";
/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=e("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),v=({validation:e,analysis:t})=>{const l=e=>{switch(e){case"HIGH":return s.jsx(N,{className:"w-4 h-4 text-red-600"});case"MEDIUM":return s.jsx(N,{className:"w-4 h-4 text-yellow-600"});case"LOW":return s.jsx(N,{className:"w-4 h-4 text-blue-600"});default:return s.jsx(a,{className:"w-4 h-4 text-gray-600"})}};return t?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(g,{className:"w-5 h-5 mr-2 text-blue-600"}),"Análise Automatizada"]}),s.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium "+(r=e.confidence||0,r>=80?"text-green-600 bg-green-100":r>=60?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100"),children:[e.confidence,"% Confiança"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Algoritmo"}),s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[t.algorithm," v",t.version]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Tempo de Processamento"}),s.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[(t.processingTime/1e3).toFixed(2),"s"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Data da Análise"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(t.timestamp).toLocaleString("pt-BR")})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Descobertas da Análise"}),s.jsx("div",{className:"space-y-3",children:t.findings.map(((e,a)=>s.jsx("div",{className:"border-l-4 border-gray-200 pl-4 py-2",children:s.jsxs("div",{className:"flex items-start",children:[l(e.severity),s.jsxs("div",{className:"ml-3 flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.dataPoint}),s.jsx("span",{className:"text-xs text-gray-500",children:e.category})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.evidence&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Evidência: ",e.evidence]}),e.suggestedAction&&s.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:[s.jsx("strong",{children:"Ação sugerida:"})," ",e.suggestedAction]})]})]})},a)))}),0===t.findings.length&&s.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Nenhuma descoberta significativa"})]}),t.recommendations.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recomendações"}),s.jsx("ul",{className:"space-y-2",children:t.recommendations.map(((e,t)=>s.jsxs("li",{className:"flex items-start",children:[s.jsx(a,{className:"w-4 h-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),s.jsx("span",{className:"text-sm text-gray-700",children:e})]},t)))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(j,{className:"w-5 h-5 mr-2"}),"Detalhamento da Confiança"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-600",children:"Precisão dos Dados"}),s.jsx("span",{className:"font-medium",children:"85%"})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"85%"}})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-600",children:"Conformidade Regulatória"}),s.jsx("span",{className:"font-medium",children:"92%"})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"92%"}})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-600",children:"Consistência"}),s.jsx("span",{className:"font-medium",children:"78%"})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-yellow-600 h-2 rounded-full",style:{width:"78%"}})})]})]})]})]}):null;var r},y=({dataPoints:e,onUpdate:a,readOnly:r=!1})=>{const[i,d]=m.useState(null),[n,c]=m.useState(""),[x,o]=m.useState(""),h=e=>{switch(e){case"PASSED":return s.jsx(t,{className:"w-5 h-5 text-green-600"});case"FAILED":return s.jsx(l,{className:"w-5 h-5 text-red-600"});case"WARNING":return s.jsx(N,{className:"w-5 h-5 text-yellow-600"});default:return s.jsx("span",{className:"w-5 h-5 text-gray-400",children:"-"})}},u=e=>{switch(e){case"PASSED":return"bg-green-50 border-green-200";case"FAILED":return"bg-red-50 border-red-200";case"WARNING":return"bg-yellow-50 border-yellow-200";default:return"bg-gray-50 border-gray-200"}},g=()=>{if(!i||!a)return;const s=e.map((e=>{var s;return e.dataPointId===i?{...e,validatedValue:n,notes:x,deviation:(null==(s=e.threshold)?void 0:s.target)?Math.abs((parseFloat(n)-e.threshold.target)/e.threshold.target*100):e.deviation}:e}));a(s),d(null),c(""),o("")},j=()=>{d(null),c(""),o("")},v=e.reduce(((e,s)=>{const a=s.source||"OUTROS";return e[a]||(e[a]=[]),e[a].push(s),e}),{});return s.jsxs("div",{className:"space-y-6",children:[Object.entries(v).map((([e,a])=>s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[s.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b",children:s.jsxs("h3",{className:"text-sm font-semibold text-gray-900",children:["LAB_REPORT"===e&&"Dados do Relatório Laboratorial","MANUAL_ENTRY"===e&&"Dados Inseridos Manualmente","AUTOMATED_ANALYSIS"===e&&"Dados da Análise Automatizada","OUTROS"===e&&"Outros Dados"]})}),s.jsx("div",{className:"divide-y divide-gray-200",children:a.map((e=>s.jsx("div",{className:`px-6 py-4 ${u(e.validationStatus)}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center",children:[h(e.validationStatus),s.jsx("h4",{className:"ml-2 text-sm font-medium text-gray-900",children:e.name})]}),i===e.dataPointId?s.jsxs("div",{className:"mt-3 space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Valor Validado"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"text",value:n,onChange:e=>c(e.target.value),className:"input flex-1 text-sm"}),e.unit&&s.jsx("span",{className:"text-sm text-gray-500",children:e.unit})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Observações"}),s.jsx("textarea",{value:x,onChange:e=>o(e.target.value),className:"input w-full text-sm",rows:2})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:g,className:"btn btn-primary btn-sm",children:[s.jsx(p,{className:"w-3 h-3 mr-1"}),"Salvar"]}),s.jsx("button",{onClick:j,className:"btn btn-secondary btn-sm",children:"Cancelar"})]})]}):s.jsxs("div",{className:"mt-2 space-y-2",children:[s.jsxs("div",{className:"flex items-baseline gap-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Valor Original:"}),s.jsxs("span",{className:"ml-2 text-sm font-medium text-gray-900",children:[e.value," ",e.unit]})]}),e.validatedValue&&e.validatedValue!==e.value&&s.jsxs("div",{children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Valor Validado:"}),s.jsxs("span",{className:"ml-2 text-sm font-medium text-blue-600",children:[e.validatedValue," ",e.unit]})]})]}),e.threshold&&s.jsxs("div",{className:"text-xs text-gray-600",children:[s.jsx("span",{children:"Limites: "}),e.threshold.min&&s.jsxs("span",{children:["Mín: ",e.threshold.min," "]}),e.threshold.max&&s.jsxs("span",{children:["Máx: ",e.threshold.max," "]}),e.threshold.target&&s.jsxs("span",{children:["Alvo: ",e.threshold.target," "]}),e.unit&&s.jsx("span",{children:e.unit})]}),void 0!==e.deviation&&s.jsxs("div",{className:"text-xs",children:[s.jsx("span",{className:"text-gray-500",children:"Desvio: "}),s.jsxs("span",{className:"font-medium "+(e.deviation>10?"text-red-600":e.deviation>5?"text-yellow-600":"text-green-600"),children:[e.deviation.toFixed(2),"%"]})]}),e.notes&&s.jsx("p",{className:"text-xs text-gray-600 italic",children:e.notes})]})]}),!r&&i!==e.dataPointId&&s.jsx("button",{onClick:()=>(e=>{d(e.dataPointId),c(e.validatedValue||e.value),o(e.notes||"")})(e),className:"ml-4 p-1 text-gray-400 hover:text-gray-600",title:"Editar",children:s.jsx(b,{className:"w-4 h-4"})})]})},e.dataPointId)))})]},e))),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Resumo da Validação"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-green-100 rounded-full",children:s.jsx(t,{className:"w-6 h-6 text-green-600"})}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter((e=>"PASSED"===e.validationStatus)).length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Aprovados"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-red-100 rounded-full",children:s.jsx(l,{className:"w-6 h-6 text-red-600"})}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter((e=>"FAILED"===e.validationStatus)).length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Reprovados"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-yellow-100 rounded-full",children:s.jsx(N,{className:"w-6 h-6 text-yellow-600"})}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter((e=>"WARNING"===e.validationStatus)).length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Avisos"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full",children:s.jsx("span",{className:"text-gray-600",children:"N/A"})}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter((e=>"NOT_APPLICABLE"===e.validationStatus)).length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Não Aplicável"})]})]})]})]})},f=({validationId:e,feedback:t,onSubmitFeedback:l,currentUserId:c})=>{const[x,o]=m.useState(!1),[h,u]=m.useState({type:"SUGGESTION",message:"",dataPointId:""}),[g,j]=m.useState(!1),p=e=>{switch(e){case"CORRECTION":return s.jsx(N,{className:"w-4 h-4 text-orange-600"});case"CONFIRMATION":return s.jsx(a,{className:"w-4 h-4 text-green-600"});case"DISPUTE":return s.jsx(N,{className:"w-4 h-4 text-red-600"});case"SUGGESTION":return s.jsx(r,{className:"w-4 h-4 text-blue-600"});default:return s.jsx(r,{className:"w-4 h-4 text-gray-600"})}},b=e=>{switch(e){case"CORRECTION":return"Correção";case"CONFIRMATION":return"Confirmação";case"DISPUTE":return"Contestação";case"SUGGESTION":return"Sugestão";default:return e}},v=e=>{switch(e){case"PENDING":return"bg-yellow-100 text-yellow-800";case"REVIEWED":return"bg-blue-100 text-blue-800";case"RESOLVED":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feedback e Comunicação"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[t.length," mensagens"]})]}),!x&&l&&s.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary",children:[s.jsx(r,{className:"w-4 h-4 mr-2"}),"Novo Feedback"]})]})}),x&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Enviar Feedback"}),s.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),l&&h.message.trim()){j(!0);try{await l({userId:c||"",validationId:e,type:h.type,message:h.message,dataPointId:h.dataPointId||void 0}),n.success("Feedback enviado com sucesso!"),u({type:"SUGGESTION",message:"",dataPointId:""}),o(!1)}catch(a){n.error("Erro ao enviar feedback")}finally{j(!1)}}},className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Feedback"}),s.jsxs("select",{value:h.type,onChange:e=>u((s=>({...s,type:e.target.value}))),className:"input w-full",required:!0,children:[s.jsx("option",{value:"SUGGESTION",children:"Sugestão"}),s.jsx("option",{value:"CORRECTION",children:"Correção"}),s.jsx("option",{value:"CONFIRMATION",children:"Confirmação"}),s.jsx("option",{value:"DISPUTE",children:"Contestação"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensagem"}),s.jsx("textarea",{value:h.message,onChange:e=>u((s=>({...s,message:e.target.value}))),className:"input w-full",rows:4,placeholder:"Descreva seu feedback...",required:!0})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"submit",disabled:g,className:"btn btn-primary",children:g?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Enviando..."]}):s.jsxs(s.Fragment,{children:[s.jsx(i,{className:"w-4 h-4 mr-2"}),"Enviar"]})}),s.jsx("button",{type:"button",onClick:()=>o(!1),className:"btn btn-secondary",children:"Cancelar"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[t.map((e=>s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start",children:[p(e.type),s.jsxs("div",{className:"ml-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.userName||"Usuário"}),s.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${v(e.status)}`,children:["PENDING"===e.status&&"Pendente","REVIEWED"===e.status&&"Revisado","RESOLVED"===e.status&&"Resolvido"]}),s.jsx("span",{className:"text-xs text-gray-500",children:b(e.type)})]}),s.jsx("p",{className:"text-sm text-gray-700 mt-2",children:e.message}),e.resolution&&s.jsxs("div",{className:"mt-3 bg-gray-50 rounded p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Resolução:"}),s.jsx("p",{className:"text-sm text-gray-700",children:e.resolution})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleDateString("pt-BR")}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}),e.resolvedAt&&s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Resolvido em ",new Date(e.resolvedAt).toLocaleDateString("pt-BR")]})]})]}),"PENDING"===e.status&&s.jsxs("div",{className:"mt-4 flex items-center text-xs text-gray-500",children:[s.jsx(d,{className:"w-3 h-3 mr-1"}),"Aguardando revisão"]})]},e.id))),0===t.length&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-12 text-center",children:[s.jsx(r,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum feedback ainda"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Seja o primeiro a fornecer feedback sobre esta validação"})]})]})]})},w=()=>{var e,a,r,i,d,j,N,p,b;const{id:w}=o(),S=h(),{user:A}=c(),[E,I]=m.useState(null),[R,D]=m.useState([]),[C,P]=m.useState(!0),[O,k]=m.useState(!1),[T,V]=m.useState("overview");m.useEffect((()=>{w&&(L(),F())}),[w]);const L=async()=>{if(w)try{P(!0);const e=await u.getValidation(w);I(e.validation)}catch(e){n.error("Erro ao carregar validação"),S("/admin/validations")}finally{P(!1)}},F=async()=>{if(w)try{const e=await u.getValidationFeedback(w);D(e.data)}catch(e){}},U=async e=>{if(w){k(!0);try{const s=await u.updateValidation(w,{status:e});I(s.validation),n.success("Status atualizado!")}catch(s){n.error("Erro ao atualizar status")}finally{k(!1)}}};return C?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"loading-spinner w-8 h-8"})}):E?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:()=>S("/admin/validations"),className:"mr-4 p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(x,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Revisar Validação"}),s.jsxs("p",{className:"text-gray-600 mt-1",children:[null==(e=E.product)?void 0:e.name," - ",null==(a=E.product)?void 0:a.brand]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:["AUTOMATED"===E.type&&s.jsxs("div",{className:"flex items-center text-blue-600",children:[s.jsx(g,{className:"w-5 h-5 mr-2"}),s.jsx("span",{className:"text-sm font-medium",children:"Validação Automatizada"})]}),void 0!==E.confidence&&s.jsxs("div",{className:"text-center",children:[s.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[E.confidence,"%"]}),s.jsx("p",{className:"text-xs text-gray-600",children:"Confiança"})]})]})]})}),s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("nav",{className:"-mb-px flex space-x-8",children:[s.jsx("button",{onClick:()=>V("overview"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("overview"===T?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Visão Geral"}),s.jsxs("button",{onClick:()=>V("data-points"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("data-points"===T?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["Pontos de Dados",E.dataPoints&&E.dataPoints.length>0&&s.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:E.dataPoints.length})]}),("AUTOMATED"===E.type||"HYBRID"===E.type)&&s.jsxs("button",{onClick:()=>V("ai-analysis"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("ai-analysis"===T?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[s.jsx(g,{className:"w-4 h-4 inline-block mr-1"}),"Análise IA"]}),s.jsxs("button",{onClick:()=>V("feedback"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("feedback"===T?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["Feedback",R.length>0&&s.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:R.length})]})]})}),"overview"===T&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status e Ações"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Status Atual"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium "+("APPROVED"===E.status?"bg-green-100 text-green-800":"REJECTED"===E.status?"bg-red-100 text-red-800":"PARTIAL"===E.status?"bg-orange-100 text-orange-800":"IN_PROGRESS"===E.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:E.status}),E.validatedAt&&s.jsxs("span",{className:"text-sm text-gray-500",children:["Validado em ",new Date(E.validatedAt).toLocaleDateString("pt-BR")]})]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Ações Rápidas"}),s.jsxs("div",{className:"flex gap-2",children:["APPROVED"!==E.status&&s.jsxs("button",{onClick:()=>U("APPROVED"),className:"btn btn-success btn-sm",disabled:O,children:[s.jsx(t,{className:"w-4 h-4 mr-1"}),"Aprovar"]}),"REJECTED"!==E.status&&s.jsxs("button",{onClick:()=>U("REJECTED"),className:"btn btn-danger btn-sm",disabled:O,children:[s.jsx(l,{className:"w-4 h-4 mr-1"}),"Rejeitar"]})]})]})]}),E.summary&&s.jsxs("div",{className:"mt-6",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Resumo"}),s.jsx("p",{className:"text-gray-900",children:E.summary})]}),E.notes&&s.jsxs("div",{className:"mt-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Observações"}),s.jsx("p",{className:"text-gray-700",children:E.notes})]})]}),s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informações do Produto"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Nome"}),s.jsx("p",{className:"text-gray-900",children:null==(r=E.product)?void 0:r.name})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Marca"}),s.jsx("p",{className:"text-gray-900",children:null==(i=E.product)?void 0:i.brand})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"SKU"}),s.jsx("p",{className:"text-gray-900",children:null==(d=E.product)?void 0:d.sku})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Categoria"}),s.jsx("p",{className:"text-gray-900",children:null==(j=E.product)?void 0:j.category})]})]}),(null==(N=E.product)?void 0:N.claims)&&s.jsxs("div",{className:"mt-4",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Claims"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:E.product.claims.split(",").map(((e,a)=>s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.trim()},a)))})]})]}),E.report&&s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Relatório Laboratorial"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Laboratório"}),s.jsx("p",{className:"text-gray-900",children:null==(p=E.report.laboratory)?void 0:p.name})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Acreditação"}),s.jsx("p",{className:"text-gray-900",children:null==(b=E.report.laboratory)?void 0:b.accreditation})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Tipo de Análise"}),s.jsx("p",{className:"text-gray-900",children:E.report.analysisType})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Data do Relatório"}),s.jsx("p",{className:"text-gray-900",children:new Date(E.report.createdAt).toLocaleDateString("pt-BR")})]})]})]})]}),"data-points"===T&&E.dataPoints&&s.jsx(y,{dataPoints:E.dataPoints,onUpdate:async e=>{if(w){k(!0);try{const s=await u.updateValidationDataPoints(w,e);I(s.data),n.success("Pontos de dados atualizados!")}catch(s){n.error("Erro ao atualizar pontos de dados")}finally{k(!1)}}},readOnly:"APPROVED"===E.status}),"ai-analysis"===T&&E.automatedAnalysis&&s.jsx(v,{validation:E,analysis:E.automatedAnalysis}),"feedback"===T&&s.jsx(f,{validationId:w,feedback:R,onSubmitFeedback:async e=>{if(!w)return;const s=await u.submitValidationFeedback(w,{...e,userId:(null==A?void 0:A.id)||"",userName:null==A?void 0:A.name});D([...R,s.data]),await F()},currentUserId:null==A?void 0:A.id})]}):null};export{w as ValidationReviewPage};
