import{r as e,V as a,j as r,F as t,X as i,aT as l,bf as s,B as c,be as n,i as o,a3 as d,ae as m,o as u,af as h,K as p,l as x,n as g,an as b,aq as y,k as f}from"./react-core-XCdXHkeW.js";import{L as N}from"./react-router-G9IXNjIc.js";import{c as v}from"./certificationService-CZY-t1yz.js";import{u as w}from"./useAsyncAction-DPqA4CQG.js";import{L as C}from"./index-D7IercYq.js";import{P as E}from"./Pagination-CQIAWTMV.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./fallbackService-QR578FZI.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";const A=({onUploadComplete:c,productId:n})=>{var o;const[d,m]=e.useState({name:"",description:"",issuer:"",number:"",issueDate:"",expiryDate:"",type:"OTHER",verificationMethod:"MANUAL",verificationUrl:"",scope:"",standards:[]}),[u,h]=e.useState(null),[p,x]=e.useState(0),[g,b]=e.useState(!1),y=e.useRef(null),{execute:f,loading:N}=w((async()=>{if(!(d.name&&d.issuer&&d.number&&d.issueDate&&d.expiryDate))return void a.error("Por favor, preencha todos os campos obrigat\xf3rios");const e=await v.createCertification(d);if(u){b(!0);try{const a=await v.uploadCertificateDocument(e.certification.id,u);await v.updateCertification(e.certification.id,{documentUrl:a.documentUrl})}catch(r){a.error("Erro ao fazer upload do documento")}finally{b(!1)}}a.success("Certifica\xe7\xe3o criada com sucesso!"),n&&await v.addProductCertification({productId:n,certificationId:e.certification.id,certificateNumber:d.number,issueDate:d.issueDate,expiryDate:d.expiryDate}),null==c||c(e.certification),m({name:"",description:"",issuer:"",number:"",issueDate:"",expiryDate:"",type:"OTHER",verificationMethod:"MANUAL",verificationUrl:"",scope:"",standards:[]}),h(null)}));return r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Nova Certifica\xe7\xe3o"}),r.jsxs("form",{onSubmit:e=>{e.preventDefault(),f()},className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Certifica\xe7\xe3o *"}),r.jsx("input",{type:"text",value:d.name,onChange:e=>m({...d,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: ISO 9001:2015",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo *"}),r.jsx("select",{value:d.type,onChange:e=>m({...d,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0,children:[{value:"ISO",label:"ISO"},{value:"HACCP",label:"HACCP"},{value:"ORGANIC",label:"Org\xe2nico"},{value:"FAIRTRADE",label:"Com\xe9rcio Justo"},{value:"KOSHER",label:"Kosher"},{value:"HALAL",label:"Halal"},{value:"VEGAN",label:"Vegano"},{value:"NON_GMO",label:"N\xe3o-OGM"},{value:"GLUTEN_FREE",label:"Sem Gl\xfaten"},{value:"RAINFOREST_ALLIANCE",label:"Rainforest Alliance"},{value:"BRC",label:"BRC"},{value:"IFS",label:"IFS"},{value:"OTHER",label:"Outro"}].map((e=>r.jsx("option",{value:e.value,children:e.label},e.value)))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Emissor *"}),r.jsx("input",{type:"text",value:d.issuer,onChange:e=>m({...d,issuer:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Bureau Veritas",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero do Certificado *"}),r.jsx("input",{type:"text",value:d.number,onChange:e=>m({...d,number:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: BR-12345/2024",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Emiss\xe3o *"}),r.jsx("input",{type:"date",value:d.issueDate,onChange:e=>m({...d,issueDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Expira\xe7\xe3o *"}),r.jsx("input",{type:"date",value:d.expiryDate,onChange:e=>m({...d,expiryDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",min:d.issueDate,required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M\xe9todo de Verifica\xe7\xe3o"}),r.jsx("select",{value:d.verificationMethod,onChange:e=>m({...d,verificationMethod:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[{value:"QR_CODE",label:"QR Code"},{value:"CERTIFICATE_NUMBER",label:"N\xfamero do Certificado"},{value:"WEBSITE",label:"Website"},{value:"API",label:"API"},{value:"MANUAL",label:"Manual"}].map((e=>r.jsx("option",{value:e.value,children:e.label},e.value)))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL de Verifica\xe7\xe3o"}),r.jsx("input",{type:"url",value:d.verificationUrl,onChange:e=>m({...d,verificationUrl:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"https://..."})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Escopo"}),r.jsx("input",{type:"text",value:d.scope,onChange:e=>m({...d,scope:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: Gest\xe3o da Qualidade, Produ\xe7\xe3o de Alimentos"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),r.jsx("textarea",{value:d.description,onChange:e=>m({...d,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Descri\xe7\xe3o detalhada da certifica\xe7\xe3o..."})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Normas/Padr\xf5es"}),r.jsx("input",{type:"text",value:null==(o=d.standards)?void 0:o.join(", "),onChange:e=>m({...d,standards:e.target.value.split(",").map((e=>e.trim())).filter((e=>e))}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ex: ISO 9001, ISO 14001 (separados por v\xedrgula)"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Documento do Certificado"}),r.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:u?r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(t,{className:"w-8 h-8 text-gray-400 mr-3"}),r.jsxs("div",{className:"text-left",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:u.name}),r.jsxs("p",{className:"text-xs text-gray-500",children:[(u.size/1024/1024).toFixed(2)," MB"]})]})]}),r.jsx("button",{type:"button",onClick:()=>{h(null),y.current&&(y.current.value="")},className:"text-gray-400 hover:text-red-600 transition-colors",children:r.jsx(i,{className:"w-5 h-5"})})]}):r.jsxs(r.Fragment,{children:[r.jsx(l,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Arraste e solte o documento aqui ou"}),r.jsx("input",{ref:y,type:"file",onChange:e=>{var r;const t=null==(r=e.target.files)?void 0:r[0];if(t){if(t.size>10485760)return void a.error("Arquivo muito grande. M\xe1ximo 10MB.");h(t)}},accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",className:"hidden"}),r.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=y.current)?void 0:e.click()},className:"btn btn-outline btn-sm",children:"Selecionar Arquivo"}),r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"PDF, DOC, DOCX, JPG ou PNG (m\xe1x. 10MB)"})]})}),g&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-1",children:[r.jsx("span",{children:"Enviando documento..."}),r.jsxs("span",{children:[p,"%"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${p}%`}})})]})]}),r.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t",children:[r.jsx("button",{type:"button",onClick:()=>{m({name:"",description:"",issuer:"",number:"",issueDate:"",expiryDate:"",type:"OTHER",verificationMethod:"MANUAL",verificationUrl:"",scope:"",standards:[]}),h(null)},className:"btn btn-outline",children:"Cancelar"}),r.jsx("button",{type:"submit",disabled:N||g,className:"btn btn-primary",children:N?r.jsxs(r.Fragment,{children:[r.jsx(s,{className:"w-4 h-4 mr-2 animate-spin"}),"Criando..."]}):"Criar Certifica\xe7\xe3o"})]})]})]})},I=({productId:t,showSettings:l=!0})=>{const[s,h]=e.useState([]),[p,x]=e.useState(!0),[g,b]=e.useState(!1),[y,f]=e.useState({expirationWarningDays:30,emailNotifications:!0,dashboardNotifications:!0}),[N,w]=e.useState(0);e.useEffect((()=>{E()}),[t]);const E=async()=>{try{x(!0);const e=await v.getCertificationAlerts({productId:t,isRead:!1});h(e),w(e.filter((e=>!e.isRead)).length)}catch(e){a.error("Erro ao carregar alertas")}finally{x(!1)}},A=e=>{switch(e){case"EXPIRING_SOON":return"Expirando em Breve";case"EXPIRED":return"Expirado";case"RENEWAL_REQUIRED":return"Renova\xe7\xe3o Necess\xe1ria";case"VERIFICATION_FAILED":return"Falha na Verifica\xe7\xe3o";case"DOCUMENT_MISSING":return"Documento Ausente";default:return e}};return p?r.jsx("div",{className:"flex justify-center items-center h-32",children:r.jsx(C,{size:"md"})}):r.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsx("div",{className:"p-4 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(c,{className:"w-5 h-5 text-gray-600 mr-2"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Alertas de Certifica\xe7\xe3o"}),N>0&&r.jsx("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-1 text-xs font-bold text-white bg-red-600 rounded-full",children:N})]}),l&&r.jsx("button",{onClick:()=>b(!0),className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(n,{className:"w-5 h-5"})})]})}),r.jsx("div",{className:"divide-y divide-gray-200",children:0===s.length?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx(c,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Nenhum alerta no momento"}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Voc\xea ser\xe1 notificado quando houver certifica\xe7\xf5es expirando"})]}):s.map((e=>{const{icon:t,color:l,bgColor:n}=(e=>{switch(e){case"EXPIRING_SOON":return{icon:u,color:"text-yellow-600",bgColor:"bg-yellow-100"};case"EXPIRED":return{icon:d,color:"text-red-600",bgColor:"bg-red-100"};case"RENEWAL_REQUIRED":return{icon:m,color:"text-blue-600",bgColor:"bg-blue-100"};case"VERIFICATION_FAILED":return{icon:i,color:"text-red-600",bgColor:"bg-red-100"};case"DOCUMENT_MISSING":return{icon:d,color:"text-orange-600",bgColor:"bg-orange-100"};default:return{icon:c,color:"text-gray-600",bgColor:"bg-gray-100"}}})(e.type);return r.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors "+(e.isRead?"":"bg-blue-50"),children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full ${n} flex items-center justify-center`,children:r.jsx(t,{className:`w-5 h-5 ${l}`})}),r.jsx("div",{className:"ml-3 flex-1",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:A(e.type)}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(p=e.createdAt,new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(p)))})]}),!e.isRead&&r.jsx("button",{onClick:()=>(async e=>{try{await v.markAlertAsRead(e),h(s.map((a=>a.id===e?{...a,isRead:!0}:a))),w((e=>Math.max(0,e-1)))}catch(r){a.error("Erro ao marcar alerta como lido")}})(e.id),className:"ml-3 text-gray-400 hover:text-gray-600",title:"Marcar como lido",children:r.jsx(o,{className:"w-4 h-4"})})]})})]})},e.id);var p}))}),g&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Configura\xe7\xf5es de Alertas"}),r.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600",children:r.jsx(i,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avisar com quantos dias de anteced\xeancia?"}),r.jsxs("select",{value:y.expirationWarningDays,onChange:e=>f({...y,expirationWarningDays:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:7,children:"7 dias"}),r.jsx("option",{value:15,children:"15 dias"}),r.jsx("option",{value:30,children:"30 dias"}),r.jsx("option",{value:60,children:"60 dias"}),r.jsx("option",{value:90,children:"90 dias"})]})]}),r.jsx("div",{children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:y.emailNotifications,onChange:e=>f({...y,emailNotifications:e.target.checked}),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Receber notifica\xe7\xf5es por e-mail"})]})}),r.jsx("div",{children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:y.dashboardNotifications,onChange:e=>f({...y,dashboardNotifications:e.target.checked}),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Mostrar notifica\xe7\xf5es no dashboard"})]})})]}),r.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{onClick:()=>b(!1),className:"btn btn-outline",children:"Cancelar"}),r.jsx("button",{onClick:async()=>{try{await v.configureAlertSettings(y),a.success("Configura\xe7\xf5es salvas com sucesso!"),b(!1)}catch(e){a.error("Erro ao salvar configura\xe7\xf5es")}},className:"btn btn-primary",children:"Salvar Configura\xe7\xf5es"})]})]})})]})},R=()=>{const[i,s]=e.useState([]),[c,n]=e.useState(null),[o,R]=e.useState({page:1,limit:10,search:"",status:void 0,type:void 0}),[k,D]=e.useState(1),[j,O]=e.useState(!1),[S,M]=e.useState(!1),[P,T]=e.useState([]),{execute:G,loading:U}=w((async()=>{var e;try{const a=await v.getCertifications(o);a&&a.data?(s(a.data),D((null==(e=a.pagination)?void 0:e.totalPages)||1)):(s([]),D(1))}catch(a){s([]),D(1)}})),{execute:L}=w((async()=>{const e=await v.getCertificationStatistics();n(e)}));return e.useEffect((()=>{G(),L()}),[o]),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gerenciar Certifica\xe7\xf5es"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie certifica\xe7\xf5es e selos de qualidade dos produtos"})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("button",{onClick:async()=>{try{const e=[["Nome","Tipo","Emissor","N\xfamero","Status","Data de Emiss\xe3o","Data de Expira\xe7\xe3o"],...i.map((e=>[e.name,v.getCertificationTypeLabel(e.type),e.issuer,e.number,v.getCertificationStatusLabel(e.status),new Date(e.issueDate).toLocaleDateString("pt-BR"),new Date(e.expiryDate).toLocaleDateString("pt-BR")]))].map((e=>e.join(","))).join("\n"),r=new Blob([e],{type:"text/csv"}),t=window.URL.createObjectURL(r),l=document.createElement("a");l.href=t,l.download=`certifications_${(new Date).toISOString().split("T")[0]}.csv`,l.click(),window.URL.revokeObjectURL(t),a.success("Certifica\xe7\xf5es exportadas com sucesso!")}catch(e){a.error("Erro ao exportar certifica\xe7\xf5es")}},className:"btn btn-outline",children:[r.jsx(h,{className:"w-4 h-4 mr-2"}),"Exportar"]}),r.jsxs("button",{onClick:()=>O(!0),className:"btn btn-primary",children:[r.jsx(p,{className:"w-4 h-4 mr-2"}),"Nova Certifica\xe7\xe3o"]})]})]}),c&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.total})]}),r.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:r.jsx(x,{className:"w-6 h-6 text-gray-600"})})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-green-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Ativas"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:c.active})]}),r.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:r.jsx(g,{className:"w-6 h-6 text-green-600"})})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-red-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Expiradas"}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:c.expired})]}),r.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:r.jsx(d,{className:"w-6 h-6 text-red-600"})})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-yellow-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Expirando"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:c.expiringSoon})]}),r.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:r.jsx(u,{className:"w-6 h-6 text-yellow-600"})})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:r.jsxs("form",{onSubmit:e=>{e.preventDefault(),R({...o,page:1})},className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),r.jsx("input",{type:"text",value:o.search,onChange:e=>R({...o,search:e.target.value}),placeholder:"Buscar certifica\xe7\xf5es...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),r.jsxs("select",{value:o.status||"",onChange:e=>R({...o,status:e.target.value||void 0}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os Status"}),r.jsx("option",{value:"ACTIVE",children:"Ativo"}),r.jsx("option",{value:"EXPIRED",children:"Expirado"}),r.jsx("option",{value:"PENDING",children:"Pendente"}),r.jsx("option",{value:"SUSPENDED",children:"Suspenso"}),r.jsx("option",{value:"REVOKED",children:"Revogado"})]}),r.jsxs("select",{value:o.type||"",onChange:e=>R({...o,type:e.target.value||void 0}),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[r.jsx("option",{value:"",children:"Todos os Tipos"}),r.jsx("option",{value:"ISO",children:"ISO"}),r.jsx("option",{value:"HACCP",children:"HACCP"}),r.jsx("option",{value:"ORGANIC",children:"Org\xe2nico"}),r.jsx("option",{value:"FAIRTRADE",children:"Com\xe9rcio Justo"}),r.jsx("option",{value:"KOSHER",children:"Kosher"}),r.jsx("option",{value:"HALAL",children:"Halal"}),r.jsx("option",{value:"VEGAN",children:"Vegano"}),r.jsx("option",{value:"NON_GMO",children:"N\xe3o-OGM"}),r.jsx("option",{value:"GLUTEN_FREE",children:"Sem Gl\xfaten"})]}),r.jsxs("button",{type:"submit",className:"btn btn-primary",children:[r.jsx(y,{className:"w-4 h-4 mr-2"}),"Filtrar"]})]})}),P&&P.length>0&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("p",{className:"text-sm text-blue-800",children:[P.length," certifica\xe7\xe3o(\xf5es) selecionada(s)"]}),r.jsx("button",{onClick:async()=>{if(P&&0!==P.length){if(confirm(`Deseja remover ${P.length} certifica\xe7\xe3o(\xf5es)?`))try{await Promise.all(P.map((e=>v.deleteCertification(e)))),a.success("Certifica\xe7\xf5es removidas com sucesso!"),T([]),G(),L()}catch(e){a.error("Erro ao remover certifica\xe7\xf5es")}}else a.error("Selecione pelo menos uma certifica\xe7\xe3o")},className:"btn btn-sm bg-red-600 text-white hover:bg-red-700",children:"Remover Selecionadas"})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:U?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx(C,{size:"lg"})}):i&&0!==i.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left",children:r.jsx("input",{type:"checkbox",checked:P&&i&&P.length===i.length,onChange:()=>{i&&P&&(P.length===i.length?T([]):T(i.map((e=>e.id))))},className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Certifica\xe7\xe3o"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Emissor"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expira\xe7\xe3o"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i&&i.map((e=>{const a=v.getCertificationStatusColor(e.status),i=v.getDaysUntilExpiry(e.expiryDate);return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsx("input",{type:"checkbox",checked:P&&P.includes(e.id),onChange:()=>{return a=e.id,void T((e=>e.includes(a)?e.filter((e=>e!==a)):[...e,a]));var a},className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsxs("p",{className:"text-sm text-gray-500",children:["#",e.number]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"text-sm text-gray-900",children:v.getCertificationTypeLabel(e.type)})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:"text-sm text-gray-900",children:e.issuer})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-${a}-100 text-${a}-800`,children:v.getCertificationStatusLabel(e.status)})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center text-sm",children:[r.jsx(m,{className:"w-4 h-4 mr-1 text-gray-400"}),r.jsx("span",{className:i<30?"text-red-600 font-medium":"text-gray-900",children:v.formatExpiryDate(e.expiryDate)})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("div",{className:"flex items-center space-x-2",children:r.jsx(N,{to:`/dashboard/certifications/${e.id}`,className:"text-primary-600 hover:text-primary-700",children:r.jsx(t,{className:"w-4 h-4"})})})})]},e.id)}))})]})}),r.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:r.jsx(E,{currentPage:o.page||1,totalPages:k,onPageChange:e=>R({...o,page:e})})})]}):r.jsxs("div",{className:"text-center py-12",children:[r.jsx(x,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma certifica\xe7\xe3o encontrada"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Comece adicionando sua primeira certifica\xe7\xe3o"}),r.jsxs("button",{onClick:()=>O(!0),className:"btn btn-primary",children:[r.jsx(p,{className:"w-4 h-4 mr-2"}),"Adicionar Certifica\xe7\xe3o"]})]})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsx(I,{}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"A\xe7\xf5es R\xe1pidas"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("button",{onClick:()=>M(!0),className:"w-full btn btn-outline justify-start",children:[r.jsx(l,{className:"w-4 h-4 mr-2"}),"Upload em Massa"]}),r.jsxs(N,{to:"/dashboard/certifications/calendar",className:"w-full btn btn-outline justify-start",children:[r.jsx(m,{className:"w-4 h-4 mr-2"}),"Calend\xe1rio de Expira\xe7\xf5es"]}),r.jsxs(N,{to:"/dashboard/certifications/analytics",className:"w-full btn btn-outline justify-start",children:[r.jsx(f,{className:"w-4 h-4 mr-2"}),"Relat\xf3rio de Certifica\xe7\xf5es"]})]})]}),c&&c.upcomingExpirations&&c.upcomingExpirations.length>0&&r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Pr\xf3ximas Expira\xe7\xf5es"}),r.jsx("div",{className:"space-y-3",children:c.upcomingExpirations.slice(0,5).map((({certification:e,daysUntilExpiry:a})=>r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsx("p",{className:"text-xs text-gray-500",children:e.issuer})]}),r.jsxs("span",{className:"text-xs font-medium "+(a<30?"text-red-600":"text-yellow-600"),children:[a," dias"]})]},e.id)))})]})]})]}),j&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx(A,{onUploadComplete:e=>{O(!1),G(),L(),a.success("Certifica\xe7\xe3o adicionada com sucesso!")}}),r.jsx("div",{className:"p-4 border-t",children:r.jsx("button",{onClick:()=>O(!1),className:"btn btn-outline w-full",children:"Cancelar"})})]})})]})};export{R as default};
