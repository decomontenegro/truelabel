import{r as a,j as e,K as t,an as r,aR as s,n as i,au as l,aM as o,aN as c,Y as n,ak as d,aS as m,ay as b}from"./react-core-XCdXHkeW.js";import{b as h}from"./index-D7IercYq.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./react-router-G9IXNjIc.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";const x={async getLaboratories(a={}){const e=new URLSearchParams;Object.entries(a).forEach((([a,t])=>{void 0!==t&&""!==t&&e.append(a,String(t))}));const t=await h.get(`/laboratories?${e.toString()}`),r=t.data.laboratories||[];return{data:r,pagination:t.data.pagination||{page:1,limit:10,total:r.length,totalPages:1}}},getLaboratory:async a=>(await h.get(`/laboratories/${a}`)).data,createLaboratory:async a=>(await h.post("/laboratories",a)).data,updateLaboratory:async(a,e)=>(await h.put(`/laboratories/${a}`,e)).data,updateLaboratoryStatus:async(a,e)=>(await h.patch(`/laboratories/${a}/status`,{isActive:e})).data,deleteLaboratory:async a=>(await h.delete(`/laboratories/${a}`)).data,getLaboratoryStats:async a=>(await h.get(`/laboratories/${a}/stats`)).data,async getActiveLaboratories(){return(await this.getLaboratories({active:!0,limit:100})).data},async searchLaboratories(a){return(await this.getLaboratories({search:a,active:!0,limit:20})).data},async checkEmailAvailability(a,e){try{return{available:!(await this.getLaboratories({limit:1e3})).data.some((t=>t.email.toLowerCase()===a.toLowerCase()&&(!e||t.id!==e)))}}catch(t){return{available:!1}}},async getTopLaboratories(a=5){return(await this.getLaboratories({limit:100})).data.sort(((a,e)=>{var t,r;const s=(null==(t=a.t)?void 0:t.reports)||0;return((null==(r=e.t)?void 0:r.reports)||0)-s})).slice(0,a)},validateLaboratoryData(a){const e=[];return(!a.name||a.name.trim().length<2)&&e.push("Nome deve ter pelo menos 2 caracteres"),(!a.accreditation||a.accreditation.trim().length<1)&&e.push("Acredita\xe7\xe3o \xe9 obrigat\xf3ria"),a.email&&this.isValidEmail(a.email)||e.push("Email inv\xe1lido"),a.phone&&!this.isValidPhone(a.phone)&&e.push("Telefone inv\xe1lido"),{isValid:0===e.length,errors:e}},isValidEmail:a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),isValidPhone:a=>/^(\(?\d{2}\)?\s?)?\d{4,5}-?\d{4}$/.test(a.replace(/\s/g,"")),formatPhone(a){const e=a.replace(/\D/g,"");return 10===e.length?`(${e.slice(0,2)}) ${e.slice(2,6)}-${e.slice(6)}`:11===e.length?`(${e.slice(0,2)}) ${e.slice(2,7)}-${e.slice(7)}`:a},getCommonAccreditations:()=>["ISO/IEC 17025:2017","ISO/IEC 17025:2005","ABNT NBR ISO/IEC 17025","INMETRO","ANVISA","MAPA","Rede Brasileira de Laborat\xf3rios de Ensaios","CGCRE","Outros"]},u=()=>{const[h,u]=a.useState([]),[y,p]=a.useState(!0),[g,f]=a.useState(""),[w,C]=a.useState(!1),[L,j]=a.useState(null),$=async()=>{try{p(!0);const a=await x.getLaboratories({search:g,limit:100});u(a.data)}catch(a){b.error("Erro ao carregar laborat\xf3rios")}finally{p(!1)}};return a.useEffect((()=>{$()}),[g]),y?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"loading-spinner w-8 h-8"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Laborat\xf3rios"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie laborat\xf3rios certificados"})]}),e.jsxs("button",{onClick:()=>C(!0),className:"btn btn-primary",children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),"Novo Laborat\xf3rio"]})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:e.jsx("div",{className:"flex gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Buscar laborat\xf3rios...",value:g,onChange:a=>f(a.target.value),className:"input pl-10"})]})})})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:h.map((a=>{var t;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(s,{className:"w-8 h-8 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.accreditation})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:a.isActive?e.jsx(i,{className:"w-5 h-5 text-green-500"}):e.jsx(l,{className:"w-5 h-5 text-red-500"})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),a.email]}),a.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(c,{className:"w-4 h-4 mr-2"}),a.phone]}),a.address&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(n,{className:"w-4 h-4 mr-2"}),a.address]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:(null==(t=a.t)?void 0:t.reports)||0})," relat\xf3rios enviados"]})}),e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.isActive?"Ativo":"Inativo"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>j(a),className:"flex-1 btn btn-outline text-sm",children:[e.jsx(d,{className:"w-4 h-4 mr-1"}),"Editar"]}),e.jsx("button",{onClick:()=>(async a=>{try{await x.updateLaboratoryStatus(a.id,!a.isActive),b.success(`Laborat\xf3rio ${a.isActive?"desativado":"ativado"} com sucesso`),$()}catch(e){b.error("Erro ao alterar status do laborat\xf3rio")}})(a),className:"flex-1 btn text-sm "+(a.isActive?"btn-secondary":"btn-primary"),children:a.isActive?"Desativar":"Ativar"}),e.jsx("button",{onClick:()=>(async a=>{var e,t;if(confirm(`Tem certeza que deseja remover o laborat\xf3rio "${a.name}"?`))try{await x.deleteLaboratory(a.id),b.success("Laborat\xf3rio removido com sucesso"),$()}catch(r){b.error((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.message)||"Erro ao remover laborat\xf3rio")}})(a),className:"btn btn-outline text-red-600 hover:bg-red-50 text-sm px-3",children:e.jsx(m,{className:"w-4 h-4"})})]})]},a.id)}))}),0===h.length&&!y&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(s,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum laborat\xf3rio encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:g?"Tente ajustar os filtros de busca":"Comece cadastrando o primeiro laborat\xf3rio"}),!g&&e.jsxs("button",{onClick:()=>C(!0),className:"btn btn-primary",children:[e.jsx(t,{className:"w-4 h-4 mr-2"}),"Cadastrar Laborat\xf3rio"]})]}),w&&e.jsx(N,{onClose:()=>C(!1),onSuccess:()=>{C(!1),$()}}),L&&e.jsx(v,{laboratory:L,onClose:()=>j(null),onSuccess:()=>{j(null),$()}})]})},N=({onClose:a,onSuccess:t})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Novo Laborat\xf3rio"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Modal de cria\xe7\xe3o ser\xe1 implementado na pr\xf3xima etapa"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:a,className:"btn btn-secondary flex-1",children:"Cancelar"}),e.jsx("button",{onClick:t,className:"btn btn-primary flex-1",children:"Criar (Demo)"})]})]})}),v=({laboratory:a,onClose:t,onSuccess:r})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Editar Laborat\xf3rio"}),e.jsxs("p",{className:"text-gray-600 mb-2",children:["Editando: ",a.name]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Modal de edi\xe7\xe3o ser\xe1 implementado na pr\xf3xima etapa"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Cancelar"}),e.jsx("button",{onClick:r,className:"btn btn-primary flex-1",children:"Salvar (Demo)"})]})]})});export{u as LaboratoriesPage,u as default};
