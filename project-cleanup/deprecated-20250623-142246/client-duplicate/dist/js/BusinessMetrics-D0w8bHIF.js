import{r as e,j as s,af as a,P as t,n as l,Q as i,J as c,br as n}from"./react-core-XCdXHkeW.js";import{B as r,C as d}from"./Card-riUsgTF1.js";import{L as m,b as o}from"./index-D7IercYq.js";import{u as h}from"./useAsyncAction-DPqA4CQG.js";import{R as p,L as x,C as N,X as f,Y as g,T as y,a as u,b,P as v,c as w,d as j,B,e as $}from"./charts-D3dXSOka.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./react-router-G9IXNjIc.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";function R(){const[R,C]=e.useState("30d"),[P,S]=e.useState(null),[T,V]=e.useState([]),[k,A]=e.useState([]),{execute:K,loading:D}=h((async()=>{const[e,s,a]=await Promise.all([o.get(`/analytics/metrics?period=${R}`),o.get("/analytics/metrics/scans?groupBy=day&limit=30"),o.get("/analytics/metrics/products?limit=10")]);S(e.data.data),V(s.data.data),A(a.data.data)}));e.useEffect((()=>{K()}),[R]);const F=async e=>{try{const s=await o.get(`/analytics/metrics/export?format=${e}&period=${R}`,{responseType:"blob"}),a=new Blob([s.data]),t=window.URL.createObjectURL(a),l=document.createElement("a");l.href=t,l.download=`metrics-${R}-${Date.now()}.${e}`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(t),document.body.removeChild(l)}catch(s){}};if(D||!P)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx(m,{size:"large"})});const L=[{name:"Aprovadas",value:P.validations.approved,color:"#10B981"},{name:"Pendentes",value:P.validations.pending,color:"#F59E0B"},{name:"Rejeitadas",value:P.validations.rejected,color:"#EF4444"}];return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsx("div",{className:"mb-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"M\xe9tricas de Neg\xf3cio"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Vis\xe3o geral do desempenho da plataforma"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("select",{value:R,onChange:e=>C(e.target.value),className:"px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500",children:[s.jsx("option",{value:"7d",children:"\xdaltimos 7 dias"}),s.jsx("option",{value:"30d",children:"\xdaltimos 30 dias"}),s.jsx("option",{value:"90d",children:"\xdaltimos 90 dias"})]}),s.jsxs(r,{variant:"outline",onClick:()=>F("csv"),className:"flex items-center gap-2",children:[s.jsx(a,{className:"h-4 w-4"}),"CSV"]}),s.jsxs(r,{variant:"outline",onClick:()=>F("json"),className:"flex items-center gap-2",children:[s.jsx(a,{className:"h-4 w-4"}),"JSON"]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Total de Produtos"}),s.jsx("p",{className:"text-2xl font-bold mt-1",children:P.products.total}),s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["+",P.products.growth,"% este m\xeas"]})]}),s.jsx(t,{className:"h-8 w-8 text-primary-600"})]})}),s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Valida\xe7\xf5es"}),s.jsx("p",{className:"text-2xl font-bold mt-1",children:P.validations.total}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[P.validations.pending," pendentes"]})]}),s.jsx(l,{className:"h-8 w-8 text-green-600"})]})}),s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"QR Scans"}),s.jsx("p",{className:"text-2xl font-bold mt-1",children:P.qrScans.total}),s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["+",P.qrScans.growth,"% hoje"]})]}),s.jsx(i,{className:"h-8 w-8 text-purple-600"})]})}),s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Usu\xe1rios Ativos"}),s.jsx("p",{className:"text-2xl font-bold mt-1",children:P.users.active}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["de ",P.users.total," total"]})]}),s.jsx(c,{className:"h-8 w-8 text-blue-600"})]})}),s.jsx(d,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"MRR"}),s.jsxs("p",{className:"text-2xl font-bold mt-1",children:["R$ ",P.revenue.mrr.toLocaleString("pt-BR")]}),s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["+",P.revenue.growth,"%"]})]}),s.jsx(n,{className:"h-8 w-8 text-green-600"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[s.jsxs(d,{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Tend\xeancia de Scans"}),s.jsx(p,{width:"100%",height:300,children:s.jsxs(x,{data:T,children:[s.jsx(N,{strokeDasharray:"3 3"}),s.jsx(f,{dataKey:"period"}),s.jsx(g,{}),s.jsx(y,{}),s.jsx(u,{}),s.jsx(b,{type:"monotone",dataKey:"scans",stroke:"#3B82F6",name:"Scans",strokeWidth:2})]})})]}),s.jsxs(d,{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Status de Valida\xe7\xf5es"}),s.jsx(p,{width:"100%",height:300,children:s.jsxs(v,{children:[s.jsx(w,{data:L,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:s})=>`${e} ${(100*s).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:L.map(((e,a)=>s.jsx(j,{fill:e.color},`cell-${a}`)))}),s.jsx(y,{})]})})]})]}),s.jsxs(d,{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Top 10 Produtos"}),s.jsx(p,{width:"100%",height:400,children:s.jsxs(B,{data:k,children:[s.jsx(N,{strokeDasharray:"3 3"}),s.jsx(f,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),s.jsx(g,{}),s.jsx(y,{}),s.jsx(u,{}),s.jsx($,{dataKey:"totalScans",fill:"#3B82F6",name:"Scans"}),s.jsx($,{dataKey:"validations",fill:"#10B981",name:"Valida\xe7\xf5es"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[s.jsxs(d,{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Distribui\xe7\xe3o de Usu\xe1rios"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Marcas"}),s.jsx("span",{className:"font-semibold",children:P.users.brands})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Laborat\xf3rios"}),s.jsx("span",{className:"font-semibold",children:P.users.laboratories})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Validadores"}),s.jsx("span",{className:"font-semibold",children:P.users.total-P.users.brands-P.users.laboratories})]})]})]}),s.jsxs(d,{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Performance"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Taxa de Aprova\xe7\xe3o"}),s.jsxs("span",{className:"font-semibold",children:[(P.validations.approved/P.validations.total*100).toFixed(1),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Produtos Validados"}),s.jsxs("span",{className:"font-semibold",children:[(P.products.validated/P.products.total*100).toFixed(1),"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Engajamento"}),s.jsxs("span",{className:"font-semibold",children:[(P.users.active/P.users.total*100).toFixed(1),"%"]})]})]})]}),s.jsxs(d,{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Insights"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["\ud83d\udcc8 Crescimento de ",P.products.growth,"% em novos produtos"]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["\ud83c\udfaf ",P.qrScans.unique," usu\xe1rios \xfanicos escanearam QR codes"]}),s.jsx("p",{className:"text-sm text-gray-600",children:"\u23f1\ufe0f Tempo m\xe9dio de valida\xe7\xe3o: 2.3 dias"})]})]})]})]})}export{R as default};
