import{r as e,j as t,Q as a,f as n,a9 as s,V as i,C as r,n as d}from"./react-core-XCdXHkeW.js";import{p as o}from"./productService-CHIPryK1.js";import{b as c}from"./index-D7IercYq.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./react-router-G9IXNjIc.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";function l(){const[l,u]=e.useState([{test:"QR Code Uniqueness",status:"pending"},{test:"Permanent QR Code Protection",status:"pending"},{test:"Individual Validation Pages",status:"pending"},{test:"Backend/Frontend Sync",status:"pending"},{test:"Data Field Completeness",status:"pending"},{test:"QR Code Security",status:"pending"}]),[m,p]=e.useState(!1),[g,h]=e.useState([]),f=(e,t,a,n)=>{u((s=>s.map((s=>s.test===e?{...s,status:t,message:a,details:n}:s))))},y=e=>{switch(e){case"pending":return t.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300"});case"running":return t.jsx(n,{className:"w-5 h-5 text-blue-500 animate-spin"});case"passed":return t.jsx(d,{className:"w-5 h-5 text-green-500"});case"failed":return t.jsx(r,{className:"w-5 h-5 text-red-500"})}},v=e=>{switch(e){case"pending":return"bg-gray-50";case"running":return"bg-blue-50";case"passed":return"bg-green-50";case"failed":return"bg-red-50"}};return t.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(a,{className:"h-8 w-8 text-primary-600"}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"QR Code Individualization Test Suite"})]}),t.jsx("button",{onClick:async()=>{p(!0),u((e=>e.map((e=>({...e,status:"pending",message:void 0,details:void 0})))));try{const e=await(async()=>{f("QR Code Uniqueness","running");try{const e={name:`Test Product ${Date.now()}`,brand:"Test Brand",category:"Test Category",sku:`TEST-SKU-${Date.now()}`,description:"Product for QR uniqueness test"},t={...e,name:`Test Product ${Date.now()+1}`,sku:`TEST-SKU-${Date.now()+1}`},{product:a}=await o.createProduct(e),{product:n}=await o.createProduct(t),s=[a,n];h(s);const i=await c.post("/qr/generate",{productId:a.id}),r=await c.post("/qr/generate",{productId:n.id});return i.data.qrCode===r.data.qrCode?f("QR Code Uniqueness","failed","QR codes n\xe3o s\xe3o \xfanicos!",{qr1:i.data.qrCode,qr2:r.data.qrCode}):f("QR Code Uniqueness","passed","QR codes s\xe3o \xfanicos",{qr1:i.data.qrCode,qr2:r.data.qrCode}),s}catch(e){return f("QR Code Uniqueness","failed",e.message),[]}})();e&&e.length>=2?(await(async e=>{f("Permanent QR Code Protection","running");try{const t=e[0],a=await c.post("/qr/generate",{productId:t.id}),n=await c.post("/qr/generate",{productId:t.id});a.data.qrCode===n.data.qrCode?f("Permanent QR Code Protection","passed","QR code permanece o mesmo ap\xf3s m\xfaltiplas tentativas",{qrCode:a.data.qrCode,attempts:2}):f("Permanent QR Code Protection","failed","QR code foi regenerado!",{first:a.data.qrCode,second:n.data.qrCode})}catch(t){f("Permanent QR Code Protection","failed",t.message)}})(e),await(async e=>{f("Individual Validation Pages","running");try{const t=await c.post("/qr/generate",{productId:e[0].id}),a=await c.post("/qr/generate",{productId:e[1].id}),n=await fetch(`${c.defaults.baseURL}/qr/validate/${t.data.qrCode}`),s=await fetch(`${c.defaults.baseURL}/qr/validate/${a.data.qrCode}`),i=await n.json(),r=await s.json();i.product.id!==r.product.id&&i.product.name!==r.product.name?f("Individual Validation Pages","passed","Cada QR code retorna dados \xfanicos do produto",{product1:{id:i.product.id,name:i.product.name},product2:{id:r.product.id,name:r.product.name}}):f("Individual Validation Pages","failed","QR codes retornam o mesmo produto!")}catch(t){f("Individual Validation Pages","failed",t.message)}})(e),await(async e=>{f("Backend/Frontend Sync","running");try{const t=e[0],a=await c.post("/qr/generate",{productId:t.id}),n=await o.getProduct(t.id);n.product.qrCode===a.data.qrCode?f("Backend/Frontend Sync","passed","QR code sincronizado entre backend e frontend",{backendQR:a.data.qrCode,productQR:n.product.qrCode}):f("Backend/Frontend Sync","failed","QR code n\xe3o est\xe1 sincronizado!",{backend:a.data.qrCode,product:n.product.qrCode})}catch(t){f("Backend/Frontend Sync","failed",t.message)}})(e),await(async()=>{var e,t,a,n,s;f("Data Field Completeness","running");try{const e=Date.now(),t={name:"Complete Product Test",brand:"Test Brand",category:"Alimentos",sku:`COMPLETE-${e}`,description:"Product with all fields for testing data completeness",claims:"Organic, Non-GMO, Gluten-Free",nutritionalInfo:{servingSize:"100g",calories:250,protein:"10g",carbs:"30g",fat:"12g"},batchNumber:`BATCH-${e}`},{product:a}=await o.createProduct(t),n=await c.post("/qr/generate",{productId:a.id}),s=await fetch(`${c.defaults.baseURL}/qr/validate/${n.data.qrCode}`),i=await s.json(),r=["name","brand","category","sku"],d=["description","claims","nutritionalInfo"],l=r.filter((e=>!i.product[e])),u=d.filter((e=>i.product[e]));0===l.length?f("Data Field Completeness","passed",`Todos os campos obrigat\xf3rios presentes. Campos opcionais: ${u.length}/${d.length}`,{requiredFields:r,presentOptional:u,productData:{id:i.product.id,name:i.product.name,brand:i.product.brand,category:i.product.category,sku:i.product.sku,hasDescription:!!i.product.description,hasClaims:!!i.product.claims,hasNutritionalInfo:!!i.product.nutritionalInfo}}):f("Data Field Completeness","failed",`Campos obrigat\xf3rios faltando: ${l.join(", ")}`,{missing:l,product:i.product})}catch(i){const r=(null==(t=null==(e=i.response)?void 0:e.data)?void 0:t.error)||i.message,d=(null==(n=null==(a=i.response)?void 0:a.data)?void 0:n.details)||(null==(s=i.response)?void 0:s.data)||{};f("Data Field Completeness","failed",r,d)}})(),await(async e=>{f("QR Code Security","running");try{const t=e[0],a=(await c.post("/qr/generate",{productId:t.id})).data.qrCode,n=/^[a-f0-9]{16}$/.test(a),s=await o.createProduct({name:"Security Test Product",brand:"Test",category:"Test",sku:`SEC-${Date.now()}`}),i=a!==(await c.post("/qr/generate",{productId:s.product.id})).data.qrCode,r=16===a.length;n&&i&&r?f("QR Code Security","passed","QR codes s\xe3o seguros e imprevis\xedveis",{format:"hex 16 caracteres",entropy:"alta",predictable:!1}):f("QR Code Security","failed","Problemas de seguran\xe7a detectados",{validFormat:n,different:i,length:r})}catch(t){f("QR Code Security","failed",t.message)}})(e)):["Permanent QR Code Protection","Individual Validation Pages","Backend/Frontend Sync","Data Field Completeness","QR Code Security"].forEach((e=>{f(e,"failed","Falha ao criar produtos de teste")}))}catch(e){i.error("Erro durante os testes")}finally{p(!1)}},disabled:m,className:"btn-primary flex items-center space-x-2",children:m?t.jsxs(t.Fragment,{children:[t.jsx(n,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{children:"Running Tests..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(s,{className:"w-4 h-4"}),t.jsx("span",{children:"Run All Tests"})]})})]}),t.jsx("p",{className:"text-gray-600",children:"Comprehensive testing of QR code uniqueness, security, and validation system"})]}),t.jsx("div",{className:"space-y-4",children:l.map((e=>t.jsx("div",{className:`p-4 rounded-lg border ${v(e.status)}`,children:t.jsxs("div",{className:"flex items-start space-x-3",children:[y(e.status),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:e.test}),e.message&&t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),e.details&&t.jsx("div",{className:"mt-2 p-2 bg-gray-100 rounded text-xs font-mono",children:t.jsx("pre",{children:JSON.stringify(e.details,null,2)})})]})]})},e.test)))}),!m&&l.some((e=>"pending"!==e.status))&&t.jsxs("div",{className:"mt-8 p-6 bg-white rounded-lg shadow-sm border",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Test Summary"}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-3xl font-bold text-green-600",children:l.filter((e=>"passed"===e.status)).length}),t.jsx("div",{className:"text-sm text-gray-600",children:"Passed"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-3xl font-bold text-red-600",children:l.filter((e=>"failed"===e.status)).length}),t.jsx("div",{className:"text-sm text-gray-600",children:"Failed"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-3xl font-bold text-gray-600",children:l.filter((e=>"pending"===e.status)).length}),t.jsx("div",{className:"text-sm text-gray-600",children:"Pending"})]})]})]}),t.jsxs("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg",children:[t.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Architecture Verification"}),t.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[t.jsx("li",{children:"\u2713 QR codes use SHA256 with random component for unpredictability"}),t.jsx("li",{children:"\u2713 Backend prevents QR regeneration to protect printed products"}),t.jsx("li",{children:"\u2713 Each QR code is permanently linked to a specific product instance"}),t.jsx("li",{children:"\u2713 Validation endpoint tracks access for analytics"}),t.jsx("li",{children:"\u2713 Frontend syncs with backend to ensure data consistency"})]})]})]})}export{l as default};
