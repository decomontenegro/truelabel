import{j as e,aW as a,n as t,aX as s,a3 as l,r,av as d,aY as i,i as n,X as c,s as m,S as o,o as h,ay as x,e as N}from"./react-core-XCdXHkeW.js";import{v as g}from"./validationService-Ds-ci427.js";import{u}from"./index-D7IercYq.js";import{d as b,b as p}from"./react-router-G9IXNjIc.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./fallbackService-QR578FZI.js";import"./qrService-BwD7nkbO.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";const y=({validation:r,analysis:d})=>{const i=a=>{switch(a){case"HIGH":return e.jsx(l,{className:"w-4 h-4 text-red-600"});case"MEDIUM":return e.jsx(l,{className:"w-4 h-4 text-yellow-600"});case"LOW":return e.jsx(l,{className:"w-4 h-4 text-blue-600"});default:return e.jsx(t,{className:"w-4 h-4 text-gray-600"})}};return d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(a,{className:"w-5 h-5 mr-2 text-blue-600"}),"An\xe1lise Automatizada"]}),e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium "+(n=r.confidence||0,n>=80?"text-green-600 bg-green-100":n>=60?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100"),children:[r.confidence,"% Confian\xe7a"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Algoritmo"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[d.algorithm," v",d.version]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tempo de Processamento"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[(d.processingTime/1e3).toFixed(2),"s"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Data da An\xe1lise"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(d.timestamp).toLocaleString("pt-BR")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Descobertas da An\xe1lise"}),e.jsx("div",{className:"space-y-3",children:d.findings.map(((a,t)=>e.jsx("div",{className:"border-l-4 border-gray-200 pl-4 py-2",children:e.jsxs("div",{className:"flex items-start",children:[i(a.severity),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.dataPoint}),e.jsx("span",{className:"text-xs text-gray-500",children:a.category})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description}),a.evidence&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Evid\xeancia: ",a.evidence]}),a.suggestedAction&&e.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:[e.jsx("strong",{children:"A\xe7\xe3o sugerida:"})," ",a.suggestedAction]})]})]})},t)))}),0===d.findings.length&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Nenhuma descoberta significativa"})]}),d.recommendations.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recomenda\xe7\xf5es"}),e.jsx("ul",{className:"space-y-2",children:d.recommendations.map(((a,s)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(t,{className:"w-4 h-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:a})]},s)))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(s,{className:"w-5 h-5 mr-2"}),"Detalhamento da Confian\xe7a"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Precis\xe3o dos Dados"}),e.jsx("span",{className:"font-medium",children:"85%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"85%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Conformidade Regulat\xf3ria"}),e.jsx("span",{className:"font-medium",children:"92%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"92%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Consist\xeancia"}),e.jsx("span",{className:"font-medium",children:"78%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-600 h-2 rounded-full",style:{width:"78%"}})})]})]})]})]}):null;var n},v=({dataPoints:a,onUpdate:t,readOnly:s=!1})=>{const[m,o]=r.useState(null),[h,x]=r.useState(""),[N,g]=r.useState(""),u=a=>{switch(a){case"PASSED":return e.jsx(n,{className:"w-5 h-5 text-green-600"});case"FAILED":return e.jsx(c,{className:"w-5 h-5 text-red-600"});case"WARNING":return e.jsx(l,{className:"w-5 h-5 text-yellow-600"});default:return e.jsx("span",{className:"w-5 h-5 text-gray-400",children:"-"})}},b=e=>{switch(e){case"PASSED":return"bg-green-50 border-green-200";case"FAILED":return"bg-red-50 border-red-200";case"WARNING":return"bg-yellow-50 border-yellow-200";default:return"bg-gray-50 border-gray-200"}},p=()=>{if(!m||!t)return;const e=a.map((e=>{var a;return e.dataPointId===m?{...e,validatedValue:h,notes:N,deviation:(null==(a=e.threshold)?void 0:a.target)?Math.abs((parseFloat(h)-e.threshold.target)/e.threshold.target*100):e.deviation}:e}));t(e),o(null),x(""),g("")},y=()=>{o(null),x(""),g("")},v=a.reduce(((e,a)=>{const t=a.source||"OUTROS";return e[t]||(e[t]=[]),e[t].push(a),e}),{});return e.jsxs("div",{className:"space-y-6",children:[Object.entries(v).map((([a,t])=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b",children:e.jsxs("h3",{className:"text-sm font-semibold text-gray-900",children:["LAB_REPORT"===a&&"Dados do Relat\xf3rio Laboratorial","MANUAL_ENTRY"===a&&"Dados Inseridos Manualmente","AUTOMATED_ANALYSIS"===a&&"Dados da An\xe1lise Automatizada","OUTROS"===a&&"Outros Dados"]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:t.map((a=>e.jsx("div",{className:`px-6 py-4 ${b(a.validationStatus)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[u(a.validationStatus),e.jsx("h4",{className:"ml-2 text-sm font-medium text-gray-900",children:a.name})]}),m===a.dataPointId?e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Valor Validado"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:e=>x(e.target.value),className:"input flex-1 text-sm"}),a.unit&&e.jsx("span",{className:"text-sm text-gray-500",children:a.unit})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Observa\xe7\xf5es"}),e.jsx("textarea",{value:N,onChange:e=>g(e.target.value),className:"input w-full text-sm",rows:2})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:p,className:"btn btn-primary btn-sm",children:[e.jsx(d,{className:"w-3 h-3 mr-1"}),"Salvar"]}),e.jsx("button",{onClick:y,className:"btn btn-secondary btn-sm",children:"Cancelar"})]})]}):e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-baseline gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Valor Original:"}),e.jsxs("span",{className:"ml-2 text-sm font-medium text-gray-900",children:[a.value," ",a.unit]})]}),a.validatedValue&&a.validatedValue!==a.value&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Valor Validado:"}),e.jsxs("span",{className:"ml-2 text-sm font-medium text-blue-600",children:[a.validatedValue," ",a.unit]})]})]}),a.threshold&&e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("span",{children:"Limites: "}),a.threshold.min&&e.jsxs("span",{children:["M\xedn: ",a.threshold.min," "]}),a.threshold.max&&e.jsxs("span",{children:["M\xe1x: ",a.threshold.max," "]}),a.threshold.target&&e.jsxs("span",{children:["Alvo: ",a.threshold.target," "]}),a.unit&&e.jsx("span",{children:a.unit})]}),void 0!==a.deviation&&e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Desvio: "}),e.jsxs("span",{className:"font-medium "+(a.deviation>10?"text-red-600":a.deviation>5?"text-yellow-600":"text-green-600"),children:[a.deviation.toFixed(2),"%"]})]}),a.notes&&e.jsx("p",{className:"text-xs text-gray-600 italic",children:a.notes})]})]}),!s&&m!==a.dataPointId&&e.jsx("button",{onClick:()=>(e=>{o(e.dataPointId),x(e.validatedValue||e.value),g(e.notes||"")})(a),className:"ml-4 p-1 text-gray-400 hover:text-gray-600",title:"Editar",children:e.jsx(i,{className:"w-4 h-4"})})]})},a.dataPointId)))})]},a))),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Resumo da Valida\xe7\xe3o"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-green-100 rounded-full",children:e.jsx(n,{className:"w-6 h-6 text-green-600"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.filter((e=>"PASSED"===e.validationStatus)).length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Aprovados"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-red-100 rounded-full",children:e.jsx(c,{className:"w-6 h-6 text-red-600"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.filter((e=>"FAILED"===e.validationStatus)).length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Reprovados"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-yellow-100 rounded-full",children:e.jsx(l,{className:"w-6 h-6 text-yellow-600"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.filter((e=>"WARNING"===e.validationStatus)).length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Avisos"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-2 bg-gray-100 rounded-full",children:e.jsx("span",{className:"text-gray-600",children:"N/A"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.filter((e=>"NOT_APPLICABLE"===e.validationStatus)).length}),e.jsx("p",{className:"text-xs text-gray-600",children:"N\xe3o Aplic\xe1vel"})]})]})]})]})},f=({validationId:a,feedback:s,onSubmitFeedback:d,currentUserId:i})=>{const[n,c]=r.useState(!1),[N,g]=r.useState({type:"SUGGESTION",message:"",dataPointId:""}),[u,b]=r.useState(!1),p=a=>{switch(a){case"CORRECTION":return e.jsx(l,{className:"w-4 h-4 text-orange-600"});case"CONFIRMATION":return e.jsx(t,{className:"w-4 h-4 text-green-600"});case"DISPUTE":return e.jsx(l,{className:"w-4 h-4 text-red-600"});case"SUGGESTION":return e.jsx(m,{className:"w-4 h-4 text-blue-600"});default:return e.jsx(m,{className:"w-4 h-4 text-gray-600"})}},y=e=>{switch(e){case"CORRECTION":return"Corre\xe7\xe3o";case"CONFIRMATION":return"Confirma\xe7\xe3o";case"DISPUTE":return"Contesta\xe7\xe3o";case"SUGGESTION":return"Sugest\xe3o";default:return e}},v=e=>{switch(e){case"PENDING":return"bg-yellow-100 text-yellow-800";case"REVIEWED":return"bg-blue-100 text-blue-800";case"RESOLVED":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Feedback e Comunica\xe7\xe3o"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.length," mensagens"]})]}),!n&&d&&e.jsxs("button",{onClick:()=>c(!0),className:"btn btn-primary",children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"Novo Feedback"]})]})}),n&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Enviar Feedback"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d&&N.message.trim()){b(!0);try{await d({userId:i||"",validationId:a,type:N.type,message:N.message,dataPointId:N.dataPointId||void 0}),x.success("Feedback enviado com sucesso!"),g({type:"SUGGESTION",message:"",dataPointId:""}),c(!1)}catch(t){x.error("Erro ao enviar feedback")}finally{b(!1)}}},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Feedback"}),e.jsxs("select",{value:N.type,onChange:e=>g((a=>({...a,type:e.target.value}))),className:"input w-full",required:!0,children:[e.jsx("option",{value:"SUGGESTION",children:"Sugest\xe3o"}),e.jsx("option",{value:"CORRECTION",children:"Corre\xe7\xe3o"}),e.jsx("option",{value:"CONFIRMATION",children:"Confirma\xe7\xe3o"}),e.jsx("option",{value:"DISPUTE",children:"Contesta\xe7\xe3o"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensagem"}),e.jsx("textarea",{value:N.message,onChange:e=>g((a=>({...a,message:e.target.value}))),className:"input w-full",rows:4,placeholder:"Descreva seu feedback...",required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:u,className:"btn btn-primary",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),"Enviar"]})}),e.jsx("button",{type:"button",onClick:()=>c(!1),className:"btn btn-secondary",children:"Cancelar"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[s.map((a=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start",children:[p(a.type),e.jsxs("div",{className:"ml-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.userName||"Usu\xe1rio"}),e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${v(a.status)}`,children:["PENDING"===a.status&&"Pendente","REVIEWED"===a.status&&"Revisado","RESOLVED"===a.status&&"Resolvido"]}),e.jsx("span",{className:"text-xs text-gray-500",children:y(a.type)})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-2",children:a.message}),a.resolution&&e.jsxs("div",{className:"mt-3 bg-gray-50 rounded p-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Resolu\xe7\xe3o:"}),e.jsx("p",{className:"text-sm text-gray-700",children:a.resolution})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:new Date(a.createdAt).toLocaleDateString("pt-BR")}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(a.createdAt).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}),a.resolvedAt&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Resolvido em ",new Date(a.resolvedAt).toLocaleDateString("pt-BR")]})]})]}),"PENDING"===a.status&&e.jsxs("div",{className:"mt-4 flex items-center text-xs text-gray-500",children:[e.jsx(h,{className:"w-3 h-3 mr-1"}),"Aguardando revis\xe3o"]})]},a.id))),0===s.length&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-12 text-center",children:[e.jsx(m,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum feedback ainda"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Seja o primeiro a fornecer feedback sobre esta valida\xe7\xe3o"})]})]})]})},w=()=>{var t,s,l,d,i,m,o,h,w;const{id:E}=b(),A=p(),{user:R}=u(),[I,D]=r.useState(null),[C,S]=r.useState([]),[O,k]=r.useState(!0),[P,T]=r.useState(!1),[j,U]=r.useState("overview");r.useEffect((()=>{E&&(G(),V())}),[E]);const G=async()=>{if(E)try{k(!0);const e=await g.getValidation(E);D(e.validation)}catch(e){x.error("Erro ao carregar valida\xe7\xe3o"),A("/admin/validations")}finally{k(!1)}},V=async()=>{if(E)try{const e=await g.getValidationFeedback(E);S(e.data)}catch(e){}},L=async e=>{if(E){T(!0);try{const a=await g.updateValidation(E,{status:e});D(a.validation),x.success("Status atualizado!")}catch(a){x.error("Erro ao atualizar status")}finally{T(!1)}}};return O?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"loading-spinner w-8 h-8"})}):I?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>A("/admin/validations"),className:"mr-4 p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(N,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Revisar Valida\xe7\xe3o"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[null==(t=I.product)?void 0:t.name," - ",null==(s=I.product)?void 0:s.brand]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:["AUTOMATED"===I.type&&e.jsxs("div",{className:"flex items-center text-blue-600",children:[e.jsx(a,{className:"w-5 h-5 mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Valida\xe7\xe3o Automatizada"})]}),void 0!==I.confidence&&e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[I.confidence,"%"]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Confian\xe7a"})]})]})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>U("overview"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("overview"===j?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Vis\xe3o Geral"}),e.jsxs("button",{onClick:()=>U("data-points"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("data-points"===j?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["Pontos de Dados",I.dataPoints&&I.dataPoints.length>0&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:I.dataPoints.length})]}),("AUTOMATED"===I.type||"HYBRID"===I.type)&&e.jsxs("button",{onClick:()=>U("ai-analysis"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("ai-analysis"===j?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.jsx(a,{className:"w-4 h-4 inline-block mr-1"}),"An\xe1lise IA"]}),e.jsxs("button",{onClick:()=>U("feedback"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("feedback"===j?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["Feedback",C.length>0&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:C.length})]})]})}),"overview"===j&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status e A\xe7\xf5es"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Status Atual"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium "+("APPROVED"===I.status?"bg-green-100 text-green-800":"REJECTED"===I.status?"bg-red-100 text-red-800":"PARTIAL"===I.status?"bg-orange-100 text-orange-800":"IN_PROGRESS"===I.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:I.status}),I.validatedAt&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Validado em ",new Date(I.validatedAt).toLocaleDateString("pt-BR")]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"A\xe7\xf5es R\xe1pidas"}),e.jsxs("div",{className:"flex gap-2",children:["APPROVED"!==I.status&&e.jsxs("button",{onClick:()=>L("APPROVED"),className:"btn btn-success btn-sm",disabled:P,children:[e.jsx(n,{className:"w-4 h-4 mr-1"}),"Aprovar"]}),"REJECTED"!==I.status&&e.jsxs("button",{onClick:()=>L("REJECTED"),className:"btn btn-danger btn-sm",disabled:P,children:[e.jsx(c,{className:"w-4 h-4 mr-1"}),"Rejeitar"]})]})]})]}),I.summary&&e.jsxs("div",{className:"mt-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Resumo"}),e.jsx("p",{className:"text-gray-900",children:I.summary})]}),I.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Observa\xe7\xf5es"}),e.jsx("p",{className:"text-gray-700",children:I.notes})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informa\xe7\xf5es do Produto"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nome"}),e.jsx("p",{className:"text-gray-900",children:null==(l=I.product)?void 0:l.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Marca"}),e.jsx("p",{className:"text-gray-900",children:null==(d=I.product)?void 0:d.brand})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"SKU"}),e.jsx("p",{className:"text-gray-900",children:null==(i=I.product)?void 0:i.sku})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Categoria"}),e.jsx("p",{className:"text-gray-900",children:null==(m=I.product)?void 0:m.category})]})]}),(null==(o=I.product)?void 0:o.claims)&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Claims"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:I.product.claims.split(",").map(((a,t)=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:a.trim()},t)))})]})]}),I.report&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Relat\xf3rio Laboratorial"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Laborat\xf3rio"}),e.jsx("p",{className:"text-gray-900",children:null==(h=I.report.laboratory)?void 0:h.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Acredita\xe7\xe3o"}),e.jsx("p",{className:"text-gray-900",children:null==(w=I.report.laboratory)?void 0:w.accreditation})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tipo de An\xe1lise"}),e.jsx("p",{className:"text-gray-900",children:I.report.analysisType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Data do Relat\xf3rio"}),e.jsx("p",{className:"text-gray-900",children:new Date(I.report.createdAt).toLocaleDateString("pt-BR")})]})]})]})]}),"data-points"===j&&I.dataPoints&&e.jsx(v,{dataPoints:I.dataPoints,onUpdate:async e=>{if(E){T(!0);try{const a=await g.updateValidationDataPoints(E,e);D(a.data),x.success("Pontos de dados atualizados!")}catch(a){x.error("Erro ao atualizar pontos de dados")}finally{T(!1)}}},readOnly:"APPROVED"===I.status}),"ai-analysis"===j&&I.automatedAnalysis&&e.jsx(y,{validation:I,analysis:I.automatedAnalysis}),"feedback"===j&&e.jsx(f,{validationId:E,feedback:C,onSubmitFeedback:async e=>{if(!E)return;const a=await g.submitValidationFeedback(E,{...e,userId:(null==R?void 0:R.id)||"",userName:null==R?void 0:R.name});S([...C,a.data]),await V()},currentUserId:null==R?void 0:R.id})]}):null};export{w as ValidationReviewPage};
