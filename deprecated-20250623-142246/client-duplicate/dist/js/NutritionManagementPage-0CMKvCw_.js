import{r as e,j as a,a2 as r,b0 as t,a9 as s,F as l,n as i,C as c,au as n,ae as d,U as o,G as m,af as h,S as u,ap as N,an as p,aq as x,K as g,m as b,aa as y,k as v}from"./react-core-XCdXHkeW.js";import{p as f}from"./productService-CHIPryK1.js";import{h as w,u as C}from"./index-D7IercYq.js";import{n as R,N as A,C as I}from"./ClaimsValidator-D1SNUT0e.js";import{u as E}from"./useAsyncAction-DPqA4CQG.js";import{b as F}from"./react-router-G9IXNjIc.js";import"./vendor-BcMaAnXF.js";import"./state-QrSTFgAv.js";import"./react-dom-BslC4xag.js";import"./utils-BtzqxagS.js";import"./forms-Bk6aQ3xQ.js";const S=({productIds:s,onProductRemove:l})=>{const[i,c]=e.useState([]),[n,d]=e.useState(["calories","totalFat","saturatedFat","sodium","totalCarbohydrates","dietaryFiber","totalSugars","protein"]),{execute:o,loading:m}=E((async()=>{if(0===s.length)return;const e=await R.compareProducts(s);return c(e),e}));e.useEffect((()=>{o()}),[s]);const h={calories:"Calorias",totalFat:"Gorduras Totais",saturatedFat:"Gorduras Saturadas",transFat:"Gorduras Trans",cholesterol:"Colesterol",sodium:"S\xf3dio",totalCarbohydrates:"Carboidratos",dietaryFiber:"Fibras",totalSugars:"A\xe7\xfacares",protein:"Prote\xednas"},u={calories:"kcal",cholesterol:"mg",sodium:"mg",default:"g"},N=e=>u[e]||u.default,p=(e,a)=>e.nutritionFacts[a]||0,x=e=>e?"string"==typeof e?{A:"bg-green-500",B:"bg-green-400",C:"bg-yellow-400",D:"bg-orange-400",E:"bg-red-500"}[e]||"bg-gray-100":e>=4?"bg-green-500":e>=3?"bg-green-400":e>=2?"bg-yellow-400":"bg-orange-400":"bg-gray-100",g=e=>{if(!(null==e?void 0:e.healthStarRating))return null;const r=Math.floor(e.healthStarRating),s=e.healthStarRating%1!=0;return a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex items-center justify-center",children:[...Array(5)].map(((e,l)=>a.jsx(t,{className:w("h-4 w-4",l<r?"fill-yellow-400 text-yellow-400":l===r&&s?"fill-yellow-400 text-yellow-400 opacity-50":"text-gray-300")},l)))}),a.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[e.healthStarRating,"/5"]})]})};if(m)return a.jsxs("div",{className:"card p-8 flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Carregando compara\xe7\xe3o nutricional..."})]});if(0===i.length)return a.jsx("div",{className:"card p-8 text-center",children:a.jsx("p",{className:"text-gray-500",children:"Selecione produtos para comparar"})});const b=i.some((e=>e.scores)),y=i.some((e=>e.categoryAverage));return a.jsxs("div",{className:"space-y-6",children:[b&&a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Pontua\xe7\xf5es Nutricionais"}),a.jsx("div",{className:`grid grid-cols-1 md:grid-cols-${i.length} gap-4`,children:i.map((e=>{return a.jsxs("div",{className:"text-center",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:e.productName}),a.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[(r=e.scores,(null==r?void 0:r.nutriScore)?a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:w("inline-flex items-center justify-center w-12 h-12 rounded-full text-white font-bold",x(r.nutriScore)),children:r.nutriScore}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Nutri-Score"})]}):null),g(e.scores)]})]},e.productId);var r}))})]}),a.jsxs("div",{className:"card p-6 overflow-x-auto",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Compara\xe7\xe3o Nutricional"}),a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Nutriente"}),i.map((e=>a.jsxs("th",{className:"text-center py-3 px-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.productName}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Por ",e.nutritionFacts.servingSize,e.nutritionFacts.servingUnit]})]},e.productId))),y&&a.jsxs("th",{className:"text-center py-3 px-4",children:[a.jsx("div",{className:"font-medium text-gray-700",children:"M\xe9dia da Categoria"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Por 100g"})]})]})}),a.jsx("tbody",{children:n.map((e=>{var r;const t=Math.max(...i.map((a=>p(a,e))));return a.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4 font-medium text-gray-700",children:h[e]}),i.map((r=>{const s=p(r,e),l=((e,a)=>{if(!a||0===a)return"";const r=(e-a)/a*100;return`${r>0?"+":""}${r.toFixed(0)}%`})(s,r.categoryAverage?p({nutritionFacts:r.categoryAverage},e):0),c=s===t&&i.length>1;return a.jsxs("td",{className:"text-center py-3 px-4",children:[a.jsxs("div",{className:w("font-medium",c?"text-primary-600":"text-gray-900"),children:[s.toFixed(1)," ",N(e)]}),l&&a.jsx("div",{className:w("text-xs mt-1",l.startsWith("+")?"text-red-600":"text-green-600"),children:l})]},r.productId)})),y&&(null==(r=i[0])?void 0:r.categoryAverage)&&a.jsxs("td",{className:"text-center py-3 px-4 text-gray-600",children:[p({nutritionFacts:i[0].categoryAverage},e).toFixed(1)," ",N(e)]})]},e)}))})]})]}),a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Compara\xe7\xe3o Visual"}),a.jsx("div",{className:"space-y-6",children:n.map((e=>{const r=Math.max(...i.map((a=>p(a,e))));return a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:h[e]}),a.jsx("div",{className:"space-y-2",children:i.map((t=>{const s=p(t,e),l=r>0?s/r*100:0;return a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-32 text-sm text-gray-600 truncate",children:t.productName}),a.jsx("div",{className:"flex-1 mx-4",children:a.jsx("div",{className:"relative bg-gray-200 rounded-full h-6",children:a.jsx("div",{className:w("absolute top-0 left-0 h-full rounded-full transition-all","dietaryFiber"===e||"protein"===e?"bg-green-500":"sodium"===e||"saturatedFat"===e||"transFat"===e?"bg-red-500":"bg-blue-500"),style:{width:`${l}%`}})})}),a.jsxs("div",{className:"text-sm font-medium text-gray-700 w-20 text-right",children:[s.toFixed(1)," ",N(e)]})]},t.productId)}))})]},e)}))})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(r,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),a.jsxs("div",{className:"text-sm text-blue-700",children:[a.jsx("p",{className:"font-medium mb-1",children:"Dicas de Compara\xe7\xe3o:"}),a.jsxs("ul",{className:"space-y-1 text-xs",children:[a.jsx("li",{children:"\u2022 Valores em verde indicam nutrientes ben\xe9ficos (fibras, prote\xednas)"}),a.jsx("li",{children:"\u2022 Valores em vermelho indicam nutrientes a serem consumidos com modera\xe7\xe3o"}),a.jsx("li",{children:"\u2022 Compare produtos da mesma categoria para resultados mais relevantes"}),a.jsx("li",{children:"\u2022 Considere o tamanho da por\xe7\xe3o ao fazer compara\xe7\xf5es"})]})]})]})})]})},k=({nutritionFacts:t,healthClaims:d,productCategory:o,targetMarket:m="BRAZIL",onComplianceUpdate:h})=>{var u;const[N,p]=e.useState(null),[x,g]=e.useState(m),[b,y]=e.useState(null),{execute:v,loading:f}=E((async()=>{const e=await R.validateNutrition({nutritionFacts:t,healthClaims:d,targetMarket:m,productCategory:o});return p(e),null==h||h(e),e})),{execute:C}=E((async()=>{const e=await R.getRegulationRequirements(x);return y(e),e}));e.useEffect((()=>{v()}),[t,d,m,o]),e.useEffect((()=>{C()}),[x]);const A=e=>{switch(e){case"COMPLIANT":return a.jsx(i,{className:"h-5 w-5 text-green-600"});case"NON_COMPLIANT":return a.jsx(n,{className:"h-5 w-5 text-red-600"});case"NEEDS_REVIEW":return a.jsx(c,{className:"h-5 w-5 text-yellow-600"});default:return a.jsx(r,{className:"h-5 w-5 text-gray-600"})}},I=e=>{switch(e){case"COMPLIANT":return"bg-green-50 border-green-200 text-green-800";case"NON_COMPLIANT":return"bg-red-50 border-red-200 text-red-800";case"NEEDS_REVIEW":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},F=e=>{switch(e){case"ERROR":return a.jsx(n,{className:"h-4 w-4 text-red-600"});case"WARNING":return a.jsx(c,{className:"h-4 w-4 text-yellow-600"});case"INFO":return a.jsx(r,{className:"h-4 w-4 text-blue-600"});default:return null}},S={ANVISA:{name:"ANVISA - Brasil",description:"Ag\xeancia Nacional de Vigil\xe2ncia Sanit\xe1ria",laws:["RDC n\xba 429/2020","IN n\xba 75/2020","RDC n\xba 27/2010"]},FDA:{name:"FDA - Estados Unidos",description:"Food and Drug Administration",laws:["21 CFR 101","Nutrition Labeling and Education Act"]},EU:{name:"Uni\xe3o Europeia",description:"Regulamento da UE",laws:["Regulamento (UE) n\xba 1169/2011","Regulamento (CE) n\xba 1924/2006"]},MERCOSUL:{name:"MERCOSUL",description:"Mercado Comum do Sul",laws:["GMC/RES. N\xba 46/03","GMC/RES. N\xba 47/03"]}};return f?a.jsxs("div",{className:"card p-8 flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Verificando conformidade..."})]}):N?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:w("card p-6 border-2",I(N.overallStatus)),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[A(N.overallStatus),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold",children:["Status de Conformidade: ","COMPLIANT"===N.overallStatus?"Conforme":"NON_COMPLIANT"===N.overallStatus?"N\xe3o Conforme":"Necessita Revis\xe3o"]}),a.jsxs("p",{className:"text-sm opacity-75",children:["Verificado para o mercado: ",m]})]})]}),a.jsx(s,{className:"h-8 w-8 opacity-20"})]})}),a.jsxs("div",{className:"card",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8 px-6","aria-label":"Tabs",children:N.regulations.map((e=>a.jsx("button",{onClick:()=>g(e.regulation),className:w("py-3 px-1 border-b-2 font-medium text-sm",x===e.regulation?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[A(e.status),a.jsx("span",{children:e.regulation})]})},e.regulation)))})}),a.jsx("div",{className:"p-6",children:N.regulations.filter((e=>e.regulation===x)).map((e=>{var r,t,s;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:(null==(r=S[e.regulation])?void 0:r.name)||e.regulation}),a.jsx("p",{className:"text-sm text-gray-600",children:null==(t=S[e.regulation])?void 0:t.description})]}),a.jsx("div",{className:w("p-4 rounded-lg border",I(e.status)),children:a.jsxs("div",{className:"flex items-start space-x-3",children:[A(e.status),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"COMPLIANT"===e.status?"Conformidade Total":"NON_COMPLIANT"===e.status?"N\xe3o Conforme":"Conformidade Parcial"}),a.jsx("p",{className:"text-sm mt-1",children:e.details}),a.jsxs("p",{className:"text-xs mt-2 opacity-75",children:["\xdaltima verifica\xe7\xe3o: ",new Date(e.lastChecked).toLocaleString("pt-BR")]})]})]})}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Legisla\xe7\xe3o Aplic\xe1vel:"}),a.jsx("ul",{className:"text-xs text-gray-600 space-y-1",children:null==(s=S[e.regulation])?void 0:s.laws.map(((e,r)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx(l,{className:"h-3 w-3 mr-2 text-gray-400"}),e]},r)))})]})]},e.regulation)}))})]}),N.warnings.length>0&&a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Avisos e Recomenda\xe7\xf5es"}),a.jsx("div",{className:"space-y-3",children:N.warnings.map(((e,r)=>a.jsx("div",{className:w("p-4 rounded-lg border","ERROR"===e.severity?"bg-red-50 border-red-200":"WARNING"===e.severity?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200"),children:a.jsxs("div",{className:"flex items-start space-x-3",children:[F(e.severity),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:w("font-medium text-sm","ERROR"===e.severity?"text-red-800":"WARNING"===e.severity?"text-yellow-800":"text-blue-800"),children:e.field}),a.jsx("p",{className:w("text-sm mt-1","ERROR"===e.severity?"text-red-700":"WARNING"===e.severity?"text-yellow-700":"text-blue-700"),children:e.message}),e.regulation&&a.jsxs("p",{className:"text-xs mt-1 opacity-75",children:["Regulamenta\xe7\xe3o: ",e.regulation]})]})]})},r)))})]}),N.suggestions.length>0&&a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sugest\xf5es de Melhoria"}),a.jsx("ul",{className:"space-y-2",children:N.suggestions.map(((e,r)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx(i,{className:"h-4 w-4 text-green-600 mt-0.5 mr-3 flex-shrink-0"}),a.jsx("span",{className:"text-sm text-gray-700",children:e})]},r)))})]}),b&&a.jsxs("div",{className:"card p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Requisitos - ",null==(u=S[x])?void 0:u.name]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Campos Obrigat\xf3rios:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:b.requiredFields.map((e=>a.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded-full",children:e},e)))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Campos Opcionais:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:b.optionalFields.map((e=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:e},e)))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Requisitos de Rotulagem:"}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:b.labelingRequirements.map(((e,r)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"text-gray-400 mr-2",children:"\u2022"}),e]},r)))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Restri\xe7\xf5es de Alega\xe7\xf5es:"}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:b.claimRestrictions.map(((e,r)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx("span",{className:"text-red-400 mr-2",children:"\u2717"}),e]},r)))})]})]})]})]}):null},M=({productId:r,productName:t,nutritionFacts:s,healthClaims:i,onReportGenerated:c})=>{const[n,N]=e.useState("BRAZIL"),[p,x]=e.useState({name:"",credentials:"",registrationNumber:""}),[g,b]=e.useState(!0),[y,v]=e.useState(!0),[f,w]=e.useState(!0),{execute:C,loading:A}=E((async()=>{const e=await R.generateReport(r,{nutritionFacts:s,healthClaims:i,targetMarket:n});return null==c||c(e),e})),{execute:I,loading:F}=E((async e=>{const a=await R.exportNutritionData(r,e),s=window.URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=`nutrition-report-${t}-${(new Date).toISOString().split("T")[0]}.${e.toLowerCase()}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s)})),S=[{id:"nutrition",title:"Informa\xe7\xf5es Nutricionais",description:"Tabela nutricional completa com valores por por\xe7\xe3o e por 100g",included:!0},{id:"scores",title:"Pontua\xe7\xf5es Nutricionais",description:"Nutri-Score, Health Star Rating e outras classifica\xe7\xf5es",included:!0},{id:"claims",title:"Alega\xe7\xf5es de Sa\xfade",description:"Valida\xe7\xe3o e an\xe1lise de alega\xe7\xf5es nutricionais e de sa\xfade",included:!0},{id:"compliance",title:"Conformidade Regulat\xf3ria",description:"Verifica\xe7\xe3o de conformidade com regulamenta\xe7\xf5es",included:y},{id:"comparison",title:"Compara\xe7\xe3o com Categoria",description:"An\xe1lise comparativa com m\xe9dias da categoria",included:g},{id:"recommendations",title:"Recomenda\xe7\xf5es",description:"Sugest\xf5es de melhoria e otimiza\xe7\xe3o nutricional",included:f}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configurar Relat\xf3rio"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mercado Alvo"}),a.jsxs("select",{value:n,onChange:e=>N(e.target.value),className:"select",children:[a.jsx("option",{value:"BRAZIL",children:"Brasil (ANVISA)"}),a.jsx("option",{value:"USA",children:"Estados Unidos (FDA)"}),a.jsx("option",{value:"EU",children:"Uni\xe3o Europeia"}),a.jsx("option",{value:"MERCOSUL",children:"MERCOSUL"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Se\xe7\xf5es do Relat\xf3rio"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:y,onChange:e=>v(e.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Incluir an\xe1lise de conformidade"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:g,onChange:e=>b(e.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Incluir compara\xe7\xe3o com categoria"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:f,onChange:e=>w(e.target.checked),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Incluir recomenda\xe7\xf5es"})]})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Informa\xe7\xf5es do Nutricionista (Opcional)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nome"}),a.jsx("input",{type:"text",value:p.name,onChange:e=>x({...p,name:e.target.value}),placeholder:"Nome completo",className:"input"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Credenciais"}),a.jsx("input",{type:"text",value:p.credentials,onChange:e=>x({...p,credentials:e.target.value}),placeholder:"CRN, t\xedtulo, etc.",className:"input"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Registro"}),a.jsx("input",{type:"text",value:p.registrationNumber,onChange:e=>x({...p,registrationNumber:e.target.value}),placeholder:"N\xfamero de registro",className:"input"})]})]})]})]}),a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Pr\xe9via do Relat\xf3rio"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Relat\xf3rio de An\xe1lise Nutricional"}),a.jsx("p",{className:"text-gray-600 mt-1",children:t})]}),a.jsxs("div",{className:"text-right text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center justify-end mb-1",children:[a.jsx(d,{className:"h-4 w-4 mr-1"}),(new Date).toLocaleDateString("pt-BR")]}),p.name&&a.jsxs("div",{className:"flex items-center justify-end",children:[a.jsx(o,{className:"h-4 w-4 mr-1"}),p.name]})]})]}),a.jsx("div",{className:"space-y-4",children:S.filter((e=>e.included)).map((e=>a.jsxs("div",{className:"border-l-4 border-primary-500 pl-4",children:[a.jsx("h5",{className:"font-medium text-gray-900",children:e.title}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]},e.id)))}),a.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:a.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[a.jsx(m,{className:"h-4 w-4 mr-2"}),a.jsxs("span",{children:["Relat\xf3rio gerado para o mercado: ",n]})]})})]})]}),a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"A\xe7\xf5es"}),a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx("button",{onClick:()=>{C()},disabled:A,className:"btn-primary flex items-center",children:A?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Gerando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(l,{className:"h-4 w-4 mr-2"}),"Gerar Relat\xf3rio"]})}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Exportar como:"}),a.jsxs("button",{onClick:()=>I("PDF"),disabled:F||!r,className:"btn-outline flex items-center",children:[a.jsx(h,{className:"h-4 w-4 mr-2"}),"PDF"]}),a.jsxs("button",{onClick:()=>I("EXCEL"),disabled:F||!r,className:"btn-outline flex items-center",children:[a.jsx(h,{className:"h-4 w-4 mr-2"}),"Excel"]}),a.jsxs("button",{onClick:()=>I("JSON"),disabled:F||!r,className:"btn-outline flex items-center",children:[a.jsx(h,{className:"h-4 w-4 mr-2"}),"JSON"]})]}),a.jsxs("button",{disabled:!r,className:"btn-outline flex items-center ml-auto",children:[a.jsx(u,{className:"h-4 w-4 mr-2"}),"Enviar por Email"]})]})]}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(l,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),a.jsxs("div",{className:"text-sm text-blue-700",children:[a.jsx("p",{className:"font-medium mb-1",children:"Sobre os Relat\xf3rios Nutricionais"}),a.jsxs("ul",{className:"space-y-1 text-xs",children:[a.jsx("li",{children:"\u2022 Os relat\xf3rios s\xe3o gerados com base nas informa\xe7\xf5es nutricionais fornecidas"}),a.jsx("li",{children:"\u2022 A conformidade \xe9 verificada de acordo com as regulamenta\xe7\xf5es do mercado selecionado"}),a.jsx("li",{children:"\u2022 As pontua\xe7\xf5es nutricionais seguem metodologias internacionalmente reconhecidas"}),a.jsx("li",{children:"\u2022 Para uso oficial, recomenda-se a revis\xe3o por um nutricionista registrado"})]})]})]})})]})},O=()=>{const{user:r}=C(),t=F(),[i,c]=e.useState("editor"),[n,d]=e.useState(null),[o,m]=e.useState(null),[h,u]=e.useState([]),[R,E]=e.useState([]),[O,j]=e.useState(""),[L,P]=e.useState(""),{data:D}=N({queryKey:["products",{search:O,category:L}],queryFn:()=>f.getProducts({search:O,category:L,limit:20})}),{data:B}=N({queryKey:["categories"],queryFn:f.getCategories}),T=(null==D?void 0:D.data)||[],U=[{id:"editor",label:"Editor Nutricional",icon:b},{id:"claims",label:"Validar Alega\xe7\xf5es",icon:s},{id:"comparison",label:"Comparar Produtos",icon:v},{id:"compliance",label:"Conformidade",icon:s},{id:"reports",label:"Relat\xf3rios",icon:l}],V="ADMIN"===(null==r?void 0:r.role)||"BRAND"===(null==r?void 0:r.role),G="ADMIN"===(null==r?void 0:r.role)||"BRAND"===(null==r?void 0:r.role)||"LAB"===(null==r?void 0:r.role);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"An\xe1lise Nutricional"}),a.jsx("p",{className:"text-gray-600",children:"Gerencie informa\xe7\xf5es nutricionais e conformidade"})]})}),a.jsxs("div",{className:"card p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Selecionar Produto"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"relative md:col-span-2",children:[a.jsx(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400 pointer-events-none"}),a.jsx("input",{type:"text",placeholder:"Buscar produtos...",value:O,onChange:e=>j(e.target.value),className:"input pl-10"})]}),a.jsxs("select",{value:L,onChange:e=>P(e.target.value),className:"select",children:[a.jsx("option",{value:"",children:"Todas as categorias"}),null==B?void 0:B.map((e=>a.jsx("option",{value:e,children:e},e)))]}),a.jsxs("button",{className:"btn-outline flex items-center justify-center",children:[a.jsx(x,{className:"h-4 w-4 mr-2"}),"Filtros"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map((e=>a.jsxs("div",{className:w("p-4 border rounded-lg cursor-pointer transition-all",(null==n?void 0:n.id)===e.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"),onClick:()=>(e=>{d(e),(e.nutritionalInfo||e.nutritionInfo)&&m(e.nutritionalInfo||e.nutritionInfo),e.claims&&u(e.claims.split(",").map((e=>e.trim())).filter(Boolean))})(e),children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),a.jsx("p",{className:"text-sm text-gray-600",children:e.brand}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.category})]}),"comparison"===i&&a.jsx("button",{onClick:a=>{var r;a.stopPropagation(),r=e.id,!R.includes(r)&&R.length<4&&E([...R,r])},disabled:R.includes(e.id),className:w("ml-2 p-1 rounded",R.includes(e.id)?"bg-green-100 text-green-600":"hover:bg-gray-100"),children:a.jsx(g,{className:"h-4 w-4"})})]}),e.nutritionalInfo&&a.jsxs("div",{className:"mt-2 flex items-center text-xs text-green-600",children:[a.jsx(b,{className:"h-3 w-3 mr-1"}),"Informa\xe7\xf5es nutricionais dispon\xedveis"]})]},e.id)))}),0===T.length&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"Nenhum produto encontrado"})})]}),n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(b,{className:"h-5 w-5 text-primary-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900",children:n.name}),a.jsxs("p",{className:"text-sm text-gray-600",children:[n.brand," \u2022 ",n.category]})]})]}),a.jsxs("button",{onClick:()=>t(`/dashboard/products/${n.id}`),className:"btn-outline text-sm flex items-center",children:["Ver Produto",a.jsx(y,{className:"h-4 w-4 ml-1"})]})]})}),a.jsxs("div",{className:"card",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8 px-6","aria-label":"Tabs",children:U.map((e=>{const r=e.icon,t="reports"===e.id&&!G||"editor"===e.id&&!V;return a.jsx("button",{onClick:()=>!t&&c(e.id),disabled:t,className:w("py-3 px-1 border-b-2 font-medium text-sm transition-colors",i===e.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300",t&&"opacity-50 cursor-not-allowed"),children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(r,{className:"h-4 w-4"}),a.jsx("span",{children:e.label})]})},e.id)}))})}),a.jsxs("div",{className:"p-6",children:["editor"===i&&o&&a.jsx(A,{initialData:o,onChange:e=>{m(e)},targetMarket:"BRAZIL"}),"claims"===i&&o&&a.jsx(I,{nutritionFacts:o,initialClaims:h,onChange:e=>{u(e)},targetMarket:"BRAZIL"}),"comparison"===i&&a.jsxs("div",{className:"space-y-4",children:[R.length>0&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("p",{className:"text-sm text-blue-700",children:[R.length," produto(s) selecionado(s) para compara\xe7\xe3o"]}),a.jsx("button",{onClick:()=>E([]),className:"text-sm text-blue-600 hover:text-blue-800",children:"Limpar sele\xe7\xe3o"})]})}),a.jsx(S,{productIds:R,onProductRemove:e=>{E(R.filter((a=>a!==e)))}})]}),"compliance"===i&&o&&a.jsx(k,{nutritionFacts:o,healthClaims:h,productCategory:n.category,targetMarket:"BRAZIL"}),"reports"===i&&o&&a.jsx(M,{productId:n.id,productName:n.name,nutritionFacts:o,healthClaims:h}),!o&&"comparison"!==i&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(b,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Este produto ainda n\xe3o possui informa\xe7\xf5es nutricionais cadastradas."}),V&&a.jsxs("button",{onClick:()=>{m({servingSize:100,servingUnit:"g",calories:0,totalFat:0,saturatedFat:0,transFat:0,cholesterol:0,sodium:0,totalCarbohydrates:0,dietaryFiber:0,totalSugars:0,protein:0}),c("editor")},className:"btn-primary mt-4",children:[a.jsx(g,{className:"h-4 w-4 mr-2"}),"Adicionar Informa\xe7\xf5es Nutricionais"]})]})]})]})]})]})};export{O as default};
